---
phase: 05-visual-polish-full-coverage
plan: 02
type: execute
wave: 1
depends_on: []
files_modified:
  - src/components/odyssey-world/regions/CrystalLabDecorations.tsx
  - src/components/odyssey-world/regions/RefractionBenchDecorations.tsx
  - src/components/odyssey-world/regions/WavePlatformDecorations.tsx
  - src/components/odyssey-world/regions/ScatteringChamberDecorations.tsx
  - src/components/odyssey-world/regions/InterfaceLabDecorations.tsx
  - src/components/odyssey-world/regions/MeasurementStudioDecorations.tsx
  - src/components/odyssey-world/regions/regionRegistry.ts
  - src/components/odyssey-world/Platform.tsx
  - src/components/odyssey-world/IsometricScene.tsx
  - src/components/odyssey-world/OdysseyWorld.tsx
  - src/components/odyssey-world/HUD.tsx
  - src/components/odyssey-world/depth/DepthPanelContent.tsx
autonomous: true
requirements: [VISL-01, CONT-05]

must_haves:
  truths:
    - "Each region has a visually distinct atmosphere with unique floor textures, decorative motifs, and accent colors within a unified cool scientific palette"
    - "The light beam remains the most visually prominent element in every region -- decorations never overpower physics signals"
    - "The experience is usable on tablet and mobile screens with appropriate zoom, HUD, and panel sizing"
    - "All 6 regions share a cohesive blue-purple-cyan base palette differentiated by subtle accent hues"
  artifacts:
    - path: "src/components/odyssey-world/regions/CrystalLabDecorations.tsx"
      provides: "Monument Valley quality ice-crystal decorations with 250+ lines of rich SVG"
    - path: "src/components/odyssey-world/regions/WavePlatformDecorations.tsx"
      provides: "Interference pattern and wave motif decorations"
    - path: "src/components/odyssey-world/regions/ScatteringChamberDecorations.tsx"
      provides: "Atmospheric haze and particle trace decorations"
    - path: "src/components/odyssey-world/regions/InterfaceLabDecorations.tsx"
      provides: "Glass layer and surface ripple decorations"
    - path: "src/components/odyssey-world/regions/MeasurementStudioDecorations.tsx"
      provides: "Precision grid and detector array decorations"
    - path: "src/components/odyssey-world/regions/RefractionBenchDecorations.tsx"
      provides: "Glass surface and prism decorations"
  key_links:
    - from: "src/components/odyssey-world/regions/regionRegistry.ts"
      to: "all decoration components"
      via: "colorPalette values in RegionDefinition"
      pattern: "background.*#"
    - from: "src/components/odyssey-world/IsometricScene.tsx"
      to: "responsive viewport"
      via: "media query or useMediaQuery for initial zoom"
      pattern: "matchMedia|responsive"
---

<objective>
Elevate every region's visual atmosphere to Monument Valley quality with a unified cool scientific palette, rich SVG illustrations, subtle ambient animations, and full responsive design for desktop/tablet/mobile.

Purpose: VISL-01 requires "every frame worth pausing on" visual quality. Currently, decorations are basic scaffolding (~120 lines each) and some regions have warm/conflicting color palettes. This plan unifies the palette to cool/scientific tones, enriches decoration SVGs to 250-400 lines with layered detail, adds subtle ambient CSS animations, and makes the experience responsive across screen sizes. CONT-05 is partially addressed through responsive i18n-aware HUD.

Output: 6 upgraded decoration components, unified region color palettes, responsive viewport/HUD/panel adjustments, polished platform textures.
</objective>

<execution_context>
@/Users/jili/.claude/get-shit-done/workflows/execute-plan.md
@/Users/jili/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/05-visual-polish-full-coverage/05-RESEARCH.md

# Reference files for current state:
@src/components/odyssey-world/regions/regionRegistry.ts
@src/components/odyssey-world/regions/CrystalLabDecorations.tsx
@src/components/odyssey-world/regions/WavePlatformDecorations.tsx
@src/components/odyssey-world/regions/ScatteringChamberDecorations.tsx
@src/components/odyssey-world/regions/InterfaceLabDecorations.tsx
@src/components/odyssey-world/regions/MeasurementStudioDecorations.tsx
@src/components/odyssey-world/regions/RefractionBenchDecorations.tsx
@src/components/odyssey-world/Platform.tsx
@src/components/odyssey-world/IsometricScene.tsx
@src/components/odyssey-world/OdysseyWorld.tsx
@src/components/odyssey-world/HUD.tsx
@src/components/odyssey-world/depth/DepthPanelContent.tsx
</context>

<tasks>

<task type="auto">
  <name>Task 1: Unify region color palettes and upgrade all 6 decoration components to Monument Valley quality</name>
  <files>
    src/components/odyssey-world/regions/regionRegistry.ts
    src/components/odyssey-world/regions/CrystalLabDecorations.tsx
    src/components/odyssey-world/regions/RefractionBenchDecorations.tsx
    src/components/odyssey-world/regions/WavePlatformDecorations.tsx
    src/components/odyssey-world/regions/ScatteringChamberDecorations.tsx
    src/components/odyssey-world/regions/InterfaceLabDecorations.tsx
    src/components/odyssey-world/regions/MeasurementStudioDecorations.tsx
    src/components/odyssey-world/Platform.tsx
  </files>
  <action>
**Step 1: Update regionRegistry.ts color palettes to unified cool scientific palette.**

Per CONTEXT locked decision: "predominantly blue/purple/cyan cold tones, laboratory/tech feel." Adjust the colorPalette values in each RegionDefinition:

| Region | Background | Grid | Platform Fill | Accent | Accent Hue |
|--------|-----------|------|--------------|--------|------------|
| Crystal Lab | #e8f4fd | #b8dff5 | #d0eaf7 | #5b9fd4 | 210deg (blue) |
| Wave Platform | #ddf0f8 | #a0d8e8 | #c8e4f0 | #4db8c9 | 190deg (cyan) |
| Refraction Bench | #e4e8f4 | #bcc4e0 | #d0d6ea | #6b7db4 | 230deg (slate-blue) |
| Scattering Chamber | #1e2444 | #2a3558 | #242d50 | #5b68a4 | 235deg (indigo) |
| Interface Lab | #e4eaf2 | #b8c4dc | #d0d8ea | #5b84b4 | 220deg (cool-blue) |
| Measurement Studio | #eaecf2 | #c8ccd8 | #d8dce8 | #7080a8 | 225deg (steel) |

Note: Interface Lab shifts from green-gold to cool-blue (biggest change). Keep Scattering Chamber dark but shift from pure purple toward blue-purple. Crystal Lab stays closest to current.

**Step 2: Upgrade all 6 decoration files from ~120 lines to 250-400 lines.**

Each decoration component should gain:
- **Primary motifs** (2-3 large shapes defining region character)
- **Secondary details** (4-6 smaller repeated elements at varying scales and positions)
- **Ambient textures** (1-2 large-area subtle patterns at 0.02-0.05 opacity for depth)
- **Edge accents** (2-3 details along grid boundaries framing the area)
- **Floating elements** (1-2 elements with CSS @keyframes animation for subtle life)

ALL decorations render within the existing `<g opacity={0.35}>` wrapper to maintain beam visual dominance (VISL-03). Use CSS animations (NOT Framer Motion) for ambient effects per established pattern (Phase 3 decision). Limit animated elements to 3-5 per region max to avoid performance issues (research pitfall 6).

**Region-specific decoration enrichment:**

**Crystal Lab (ice-blue, 210deg):**
- Primary: Large hexagonal crystal cluster (3 interlocking hexagons with gradient fills), frosted glass cabinet with shelves
- Secondary: Small scattered crystal prisms, ice crystal snowflake patterns, lattice grid sections at different scales
- Textures: Subtle hexagonal grid pattern overlay at 0.03 opacity across floor area
- Edge: Frost-edge detailing along scene boundaries with tiny crystal fragments
- Animated: 1-2 crystals with gentle pulse glow (CSS opacity 0.25-0.4 over 4s ease-in-out infinite)

**Wave Platform (cyan, 190deg):**
- Primary: Large sine wave overlay spanning scene width, standing wave node markers
- Secondary: Phase circles at 0, pi/2, pi, 3pi/2 positions, interference fringe bands, small wavelength markers
- Textures: Concentric ripple pattern at 0.03 opacity centered on scene
- Edge: Wave crest motifs along boundaries
- Animated: Sine wave offset cycling (CSS translateX 0-20px over 6s linear infinite), phase markers rotating slowly

**Refraction Bench (slate-blue, 230deg):**
- Primary: Optical bench rail lines (long thin rectangles), angle protractor arcs
- Secondary: Glass surface sections at various angles, small prism triangles, lens profile curves
- Textures: Fine ruled lines (like optical bench markings) at 0.03 opacity
- Edge: Angular ruler tick marks along boundaries
- Animated: Subtle spectrum shimmer on prism triangle (CSS hue-rotate over 8s)

**Scattering Chamber (dark indigo, 235deg):**
- Primary: Atmospheric haze gradient layers (3 radialGradients at different positions), sky dome arc
- Secondary: Particle trace paths (curved dashed lines suggesting scattered light paths), telescope silhouette, small scattered dots
- Textures: Fine dot scatter pattern (100+ tiny circles at 0.02-0.04 opacity) suggesting particulate medium
- Edge: Gradient fade at boundaries suggesting infinite atmosphere
- Animated: Slow particle drift (CSS translateY -5px to 5px over 7s ease-in-out infinite) on 2-3 dots

**Interface Lab (cool-blue, 220deg):**
- Primary: Layered glass stack visualization (3-4 horizontal layers with different opacity), water surface with ripple lines
- Secondary: Angle of incidence lines (dashed rays), Fresnel curve outline suggestion, small lens shapes
- Textures: Horizontal stratification lines at 0.03 opacity suggesting layered media
- Edge: Glass edge highlights along boundaries
- Animated: Water ripple effect (CSS scaleX 0.98-1.02 over 5s ease-in-out infinite) on surface line

**Measurement Studio (steel, 225deg):**
- Primary: Precision measurement grid (fine crosshatch), detector array pattern (row of rectangles)
- Secondary: Poincare sphere wireframe (circle with latitude/longitude arcs), angular scale arcs, measurement dial indicators
- Textures: Engineering grid at 0.03 opacity (precise squares, not organic)
- Edge: Scale markings and measurement ticks along boundaries
- Animated: Slow dial rotation (CSS rotate 0-360 over 20s linear infinite) on one measurement indicator

**Step 3: Update Platform.tsx for per-region illustrated floor textures.**

The Platform component should apply region-specific floor texture patterns using the theme's colorPalette. Add subtle SVG pattern fills per region: crystal lattice for Crystal Lab, wave ripples for Wave Platform, glass layers for Refraction Bench, particle dots for Scattering Chamber, stratified layers for Interface Lab, precision grid for Measurement Studio. These should be very subtle (opacity 0.05-0.1) and not compete with the beam (VISL-03).

Keep all floor texture patterns within the existing Platform SVG structure. Use `<defs><pattern>` elements for efficient rendering.
  </action>
  <verify>
    pnpm run build passes with no TypeScript errors. Each decoration file is 250+ lines. Grep regionRegistry.ts for the updated palette hex values to confirm unified cool palette. Visual inspection: no decoration element uses Framer Motion (CSS animations only for ambient effects).
  </verify>
  <done>
    All 6 region color palettes unified to cool scientific tone (blue-purple-cyan range). All 6 decoration components upgraded to 250-400 lines with primary motifs, secondary details, ambient textures, edge accents, and subtle CSS animations. Platform textures updated per region. Interface Lab palette shifted from green-gold to cool-blue. Beam visual dominance preserved via 0.35 opacity wrapper and restrained particle count.
  </done>
</task>

<task type="auto">
  <name>Task 2: Add responsive design for tablet and mobile viewports</name>
  <files>
    src/components/odyssey-world/IsometricScene.tsx
    src/components/odyssey-world/OdysseyWorld.tsx
    src/components/odyssey-world/HUD.tsx
    src/components/odyssey-world/depth/DepthPanelContent.tsx
  </files>
  <action>
Make the Odyssey experience usable across desktop, tablet, and mobile with responsive viewport, HUD, and panel sizing. Desktop-first approach (current behavior is the desktop default).

**IsometricScene.tsx responsive viewport:**
- Add a media query check (use window.matchMedia or a simple hook) to determine device type: desktop (>1024px), tablet (768-1024px), mobile (<768px).
- Adjust initial zoom level per breakpoint:
  - Desktop: 1.0 (current default)
  - Tablet: 0.75
  - Mobile: 0.55
- Set the initial zoom in the store's camera state on mount, respecting any user-customized zoom.
- Keep the SVG viewBox at 2400x1600 (no change) -- zoom handles the adaptation.
- Add touch event handling for basic pinch-to-zoom: use pointer events (pointerdown/pointermove/pointerup) with two-finger detection to scale camera zoom. Use a simple distance-between-touches calculation. Map pinch spread to zoom factor (delta spread / 200 as zoom increment). Clamp zoom between 0.3 and 2.0.
- Ensure the existing wheel zoom still works alongside pinch zoom.

**OdysseyWorld.tsx responsive container:**
- Add responsive Tailwind classes to ensure the world container fills the screen properly on all devices.
- On mobile, add `touch-action: none` to prevent default browser gestures from interfering with scene interaction.
- Add a `safe-area-inset` padding for notched phones (env(safe-area-inset-top), etc.) using Tailwind's `[padding-top:env(safe-area-inset-top)]` syntax.

**HUD.tsx responsive layout:**
- Desktop (>1024px): Full current layout (back button, region name, minimap, settings, world map button)
- Tablet (768-1024px): Condensed layout -- smaller font sizes, minimap reduced to 80% scale, tighter padding
- Mobile (<768px): Minimal layout -- back button top-left, region name center-top (smaller), world map button top-right, minimap hidden (world map is the navigation), settings in a hamburger-style collapsible. Use Tailwind responsive prefixes: `hidden md:block` for minimap, `text-sm md:text-base` for region name, etc.

**DepthPanelContent.tsx / DepthPanel responsive width:**
- Desktop: `w-[65vw]` (current)
- Tablet: `w-[80vw]`
- Mobile: `w-full` (100vw, full overlay with prominent close button)
- Apply via Tailwind responsive classes: `w-full md:w-[80vw] lg:w-[65vw]`
- On mobile, ensure the depth panel has a clear close/back button at the top since there's no visible backdrop area to click.

**ElementPalette responsive (if it's an SVG diegetic shelf):**
- On mobile (<768px), consider moving the palette to a bottom-docked position or keeping it at current SVG coordinates but ensuring it's reachable via zoom/pan.
- Simplest approach: keep palette at current SVG position on all devices. The pinch-to-zoom and pan make it reachable. If palette is cut off on mobile, add a "palette" button in HUD that pans camera to palette position.

Use CSS media queries and Tailwind responsive prefixes throughout. Do NOT add new dependencies.
  </action>
  <verify>
    pnpm run build passes with no TypeScript errors. Grep IsometricScene.tsx for 'matchMedia' or responsive zoom logic. Grep HUD.tsx for responsive Tailwind classes ('md:', 'lg:', 'hidden'). Grep DepthPanelContent.tsx or DepthPanel for responsive width classes. No new dependencies added (check package.json unchanged).
  </verify>
  <done>
    IsometricScene adapts initial zoom per device type (1.0/0.75/0.55). Pinch-to-zoom works on touch devices via pointer events. HUD condenses on tablet and goes minimal on mobile (minimap hidden, smaller text). Depth panel scales from 65vw (desktop) to 80vw (tablet) to 100vw (mobile). Safe area insets applied for notched phones. All responsive behavior via CSS/Tailwind, no new dependencies.
  </done>
</task>

</tasks>

<verification>
1. `pnpm run build` succeeds with zero TypeScript errors
2. All 6 decoration files are 250+ lines with rich SVG content
3. regionRegistry.ts color palettes are all within the blue-purple-cyan range (180-260deg hue)
4. No decoration component uses Framer Motion for ambient animations (CSS only)
5. Platform.tsx has per-region floor texture patterns
6. IsometricScene.tsx has responsive zoom initialization
7. HUD.tsx has responsive Tailwind classes for 3 breakpoints
8. Depth panel has responsive width classes
9. No new dependencies in package.json
</verification>

<success_criteria>
- All 6 regions have visually rich, cohesive cool-palette decorations at 250-400 lines each
- Color palette unified: all regions in blue-purple-cyan range with subtle per-region accent differentiation
- Responsive: tablet zoom 0.75 and mobile zoom 0.55 with appropriate HUD/panel adaptations
- Beam dominance preserved (decorations at 0.35 opacity, restrained animations)
- Build passes with no regressions
</success_criteria>

<output>
After completion, create `.planning/phases/05-visual-polish-full-coverage/05-02-SUMMARY.md`
</output>
