<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='.9em' font-size='90'>âŸ¡</text></svg>">
    <title>åæŒ¯å…‰äº¤äº’å­¦ä¹  - PolarCraft</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            min-height: 100vh;
            background: #121218;
            font-family: 'Segoe UI', 'Microsoft YaHei', sans-serif;
            color: #e0e0e0;
        }

        /* Navigation Header */
        .nav-header {
            background: rgba(20, 20, 30, 0.95);
            border-bottom: 1px solid rgba(100, 200, 255, 0.2);
            padding: 15px 30px;
            display: flex;
            align-items: center;
            justify-content: space-between;
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            z-index: 1000;
        }

        .nav-header .logo {
            display: flex;
            align-items: center;
            gap: 12px;
            text-decoration: none;
            color: inherit;
        }

        .nav-header .logo-icon {
            font-size: 28px;
            color: #64c8ff;
        }

        .nav-header .logo-text {
            font-size: 20px;
            font-weight: bold;
            color: #64c8ff;
        }

        .nav-links {
            display: flex;
            gap: 20px;
        }

        .nav-links a {
            color: #889;
            text-decoration: none;
            padding: 8px 16px;
            border-radius: 6px;
            transition: all 0.3s;
        }

        .nav-links a:hover {
            color: #fff;
            background: rgba(100, 200, 255, 0.1);
        }

        .nav-links a.active {
            color: #64c8ff;
            background: rgba(100, 200, 255, 0.15);
        }

        /* Main Container */
        .main-container {
            display: flex;
            padding-top: 70px;
        }

        /* Sidebar */
        .sidebar {
            width: 280px;
            background: rgba(20, 20, 30, 0.8);
            border-right: 1px solid rgba(100, 200, 255, 0.1);
            height: calc(100vh - 70px);
            position: fixed;
            left: 0;
            top: 70px;
            overflow-y: auto;
            padding: 20px 0;
        }

        .sidebar-section {
            padding: 0 15px;
            margin-bottom: 25px;
        }

        .sidebar-section h3 {
            font-size: 11px;
            text-transform: uppercase;
            letter-spacing: 1px;
            color: #556;
            margin-bottom: 10px;
            padding-left: 10px;
        }

        .demo-list {
            list-style: none;
        }

        .demo-list li {
            margin-bottom: 2px;
        }

        .demo-list a {
            display: flex;
            align-items: center;
            gap: 10px;
            padding: 10px 15px;
            color: #aab;
            text-decoration: none;
            border-radius: 8px;
            transition: all 0.2s;
            font-size: 14px;
        }

        .demo-list a:hover {
            background: rgba(100, 200, 255, 0.1);
            color: #fff;
        }

        .demo-list a.active {
            background: rgba(100, 200, 255, 0.2);
            color: #64c8ff;
        }

        .demo-list .demo-num {
            width: 22px;
            height: 22px;
            background: rgba(100, 200, 255, 0.2);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 11px;
            font-weight: bold;
            color: #64c8ff;
        }

        /* Content Area */
        .content {
            flex: 1;
            margin-left: 280px;
            padding: 30px;
            min-height: calc(100vh - 70px);
        }

        /* Demo Section */
        .demo-section {
            display: none;
            animation: fadeIn 0.3s ease;
        }

        .demo-section.active {
            display: block;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .demo-header {
            margin-bottom: 30px;
        }

        .demo-header h1 {
            font-size: 32px;
            color: #fff;
            margin-bottom: 10px;
        }

        .demo-header .subtitle {
            font-size: 16px;
            color: #64c8ff;
            margin-bottom: 15px;
        }

        .demo-header p {
            color: #889;
            line-height: 1.7;
            max-width: 800px;
        }

        /* Demo Container */
        .demo-container {
            background: #1e1e28;
            border-radius: 16px;
            border: 1px solid rgba(100, 200, 255, 0.15);
            overflow: hidden;
            margin-bottom: 30px;
        }

        .demo-canvas-area {
            padding: 30px;
            display: flex;
            flex-direction: column;
            align-items: center;
            background: rgba(0, 0, 0, 0.3);
        }

        .demo-canvas-area canvas {
            background: #000;
            border-radius: 8px;
            border: 1px solid #333;
            max-width: 100%;
        }

        .demo-controls {
            padding: 25px 30px;
            background: rgba(30, 30, 40, 0.5);
            border-top: 1px solid rgba(100, 200, 255, 0.1);
        }

        .control-row {
            display: flex;
            align-items: center;
            gap: 15px;
            margin-bottom: 15px;
        }

        .control-row:last-child {
            margin-bottom: 0;
        }

        .control-row label {
            min-width: 140px;
            font-size: 14px;
            color: #aab;
        }

        .control-row input[type="range"] {
            flex: 1;
            max-width: 400px;
            cursor: pointer;
        }

        .control-row .value {
            min-width: 60px;
            text-align: right;
            font-family: monospace;
            color: #64c8ff;
            font-size: 14px;
        }

        .preset-buttons {
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
        }

        .preset-btn {
            background: rgba(100, 200, 255, 0.1);
            border: 1px solid rgba(100, 200, 255, 0.3);
            color: #aab;
            padding: 8px 16px;
            border-radius: 6px;
            cursor: pointer;
            font-size: 13px;
            transition: all 0.2s;
        }

        .preset-btn:hover {
            background: rgba(100, 200, 255, 0.2);
            color: #fff;
            border-color: rgba(100, 200, 255, 0.5);
        }

        /* Info Panel */
        .info-panel {
            background: rgba(30, 40, 60, 0.5);
            border-radius: 12px;
            padding: 25px;
            border: 1px solid rgba(100, 200, 255, 0.1);
        }

        .info-panel h3 {
            color: #64c8ff;
            font-size: 18px;
            margin-bottom: 15px;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .info-panel p {
            color: #aab;
            line-height: 1.7;
            margin-bottom: 12px;
        }

        .info-panel p:last-child {
            margin-bottom: 0;
        }

        .formula {
            font-family: 'Times New Roman', serif;
            font-style: italic;
            font-size: 1.3em;
            text-align: center;
            color: #ffcc00;
            background: rgba(0, 0, 0, 0.3);
            padding: 15px;
            border-radius: 8px;
            margin: 15px 0;
        }

        .legend {
            display: flex;
            gap: 20px;
            flex-wrap: wrap;
            margin-top: 15px;
        }

        .legend-item {
            display: flex;
            align-items: center;
            gap: 8px;
            font-size: 13px;
        }

        .legend-color {
            width: 16px;
            height: 16px;
            border-radius: 3px;
        }

        /* Status Display */
        .status-display {
            background: rgba(0, 0, 0, 0.3);
            border-radius: 8px;
            padding: 15px 20px;
            margin-top: 15px;
            display: flex;
            justify-content: space-between;
            flex-wrap: wrap;
            gap: 20px;
        }

        .status-item {
            text-align: center;
        }

        .status-item .label {
            font-size: 12px;
            color: #667;
            margin-bottom: 5px;
        }

        .status-item .value {
            font-size: 20px;
            font-weight: bold;
            color: #ffcc00;
            font-family: monospace;
        }

        /* Responsive */
        @media (max-width: 900px) {
            .sidebar {
                display: none;
            }
            .content {
                margin-left: 0;
            }
        }
    </style>
</head>
<body>
    <header class="nav-header">
        <a href="index.html" class="logo">
            <span class="logo-icon">âŸ¡</span>
            <span class="logo-text">PolarCraft</span>
        </a>
        <nav class="nav-links">
            <a href="index.html">é¦–é¡µ</a>
            <a href="demos.html" class="active">äº¤äº’å­¦ä¹ </a>
            <a href="game.html">æ¸¸æˆæ¢ç´¢</a>
        </nav>
    </header>

    <div class="main-container">
        <aside class="sidebar">
            <div class="sidebar-section">
                <h3>ç¬¬ä¸€å•å…ƒï¼šåæŒ¯æ€è°ƒåˆ¶ä¸æµ‹é‡</h3>
                <ul class="demo-list">
                    <li><a href="#demo3" class="active" data-demo="demo3">
                        <span class="demo-num">1.1</span>
                        åæŒ¯æ€ä¸ç›¸ä½
                    </a></li>
                    <li><a href="#demo1" data-demo="demo1">
                        <span class="demo-num">1.2</span>
                        é©¬å•æ–¯å®šå¾‹
                    </a></li>
                    <li><a href="#demo4" data-demo="demo4">
                        <span class="demo-num">1.3</span>
                        åŒæŠ˜å°„æ™¶ä½“
                    </a></li>
                    <li><a href="#demo5" data-demo="demo5">
                        <span class="demo-num">1.4</span>
                        æ³¢ç‰‡æ•ˆåº”
                    </a></li>
                </ul>
            </div>
            <div class="sidebar-section">
                <h3>ç¬¬äºŒå•å…ƒï¼šç•Œé¢åå°„åæŒ¯</h3>
                <ul class="demo-list">
                    <li><a href="#demo6" data-demo="demo6">
                        <span class="demo-num">2.1</span>
                        å¸ƒå„’æ–¯ç‰¹è§’
                    </a></li>
                </ul>
            </div>
            <div class="sidebar-section">
                <h3>ç¬¬ä¸‰å•å…ƒï¼šé€æ˜ä»‹è´¨åæŒ¯</h3>
                <ul class="demo-list">
                    <li><a href="#demo7" data-demo="demo7">
                        <span class="demo-num">3.1</span>
                        è‰²åæŒ¯ä¸å¹²æ¶‰
                    </a></li>
                    <li><a href="#demo8" data-demo="demo8">
                        <span class="demo-num">3.2</span>
                        æ—‹å…‰æ€§
                    </a></li>
                    <li><a href="#demo9" data-demo="demo9">
                        <span class="demo-num">3.3</span>
                        å…‰å¼¹æ€§æ•ˆåº”
                    </a></li>
                </ul>
            </div>
            <div class="sidebar-section">
                <h3>ç¬¬å››å•å…ƒï¼šæµ‘æµŠä»‹è´¨æ•£å°„</h3>
                <ul class="demo-list">
                    <li><a href="#demo10" data-demo="demo10">
                        <span class="demo-num">4.1</span>
                        ç‘åˆ©ä¸ç±³æ°æ•£å°„
                    </a></li>
                </ul>
            </div>
            <div class="sidebar-section">
                <h3>ç¬¬äº”å•å…ƒï¼šå…¨åæŒ¯æŠ€æœ¯</h3>
                <ul class="demo-list">
                    <li><a href="#demo11" data-demo="demo11">
                        <span class="demo-num">5.1</span>
                        StokesçŸ¢é‡ä¸MuellerçŸ©é˜µ
                    </a></li>
                </ul>
            </div>
            <div class="sidebar-section">
                <h3>æ¸¸æˆæ¢ç´¢</h3>
                <ul class="demo-list">
                    <li><a href="#demo2" data-demo="demo2">
                        <span class="demo-num">âš¡</span>
                        PolarCraft æ¸¸æˆåŸå‹
                    </a></li>
                </ul>
            </div>
        </aside>

        <main class="content">
            <!-- Demo 1: Malus's Law -->
            <section id="demo1" class="demo-section">
                <div class="demo-header">
                    <h1>é©¬å•æ–¯å®šå¾‹</h1>
                    <p class="subtitle">Malus's Law - åæŒ¯å…‰é€šè¿‡æ£€åå™¨çš„å¼ºåº¦å˜åŒ–</p>
                    <p>å½“çº¿åæŒ¯å…‰é€šè¿‡æ£€åå™¨ï¼ˆåˆ†æå™¨ï¼‰æ—¶ï¼Œé€å°„å…‰å¼ºåº¦ä¸åæŒ¯æ–¹å‘å’Œæ£€åå™¨é€å…‰è½´å¤¹è§’çš„ä½™å¼¦å¹³æ–¹æˆæ­£æ¯”ã€‚è¿™æ˜¯åæŒ¯å…‰å­¦ä¸­æœ€åŸºç¡€ä¹Ÿæ˜¯æœ€é‡è¦çš„å®šå¾‹ä¹‹ä¸€ã€‚</p>
                </div>
                <div class="demo-container">
                    <div class="demo-canvas-area">
                        <canvas id="canvas1" width="550" height="300"></canvas>
                    </div>
                    <div class="demo-controls">
                        <div class="control-row">
                            <label>æ£€åå™¨è§’åº¦ (Î¸):</label>
                            <input type="range" id="angle1" min="0" max="360" value="0">
                            <span class="value" id="angle1Val">0Â°</span>
                        </div>
                    </div>
                </div>
                <div class="info-panel">
                    <h3>ç‰©ç†åŸç†</h3>
                    <div class="formula">I = I<sub>0</sub> cosÂ²(Î¸)</div>
                    <p><strong>é©¬å•æ–¯å®šå¾‹</strong>ï¼ˆ1809å¹´ï¼‰æè¿°äº†åæŒ¯å…‰é€šè¿‡åæŒ¯ç‰‡æ—¶çš„å¼ºåº¦å˜åŒ–è§„å¾‹ã€‚å…¶ä¸­ Iâ‚€ æ˜¯å…¥å°„å…‰å¼ºï¼ŒÎ¸ æ˜¯å…¥å°„å…‰åæŒ¯æ–¹å‘ä¸åæŒ¯ç‰‡é€å…‰è½´çš„å¤¹è§’ã€‚</p>
                    <p>å½“ Î¸ = 0Â° æ—¶ï¼Œå…‰å¼ºæœ€å¤§ï¼ˆI = Iâ‚€ï¼‰ï¼›å½“ Î¸ = 90Â° æ—¶ï¼Œå…‰å¼ºä¸ºé›¶ï¼ˆæ¶ˆå…‰çŠ¶æ€ï¼‰ã€‚è¿™ä¸ªå®šå¾‹æ˜¯æ‰€æœ‰åæŒ¯å…‰å­¦å®éªŒå’Œåº”ç”¨çš„åŸºç¡€ã€‚</p>
                    <div class="status-display">
                        <div class="status-item">
                            <div class="label">é€å°„å…‰å¼º</div>
                            <div class="value" id="intensity1">100%</div>
                        </div>
                        <div class="status-item">
                            <div class="label">cosÂ²(Î¸)</div>
                            <div class="value" id="cos2val1">1.00</div>
                        </div>
                    </div>
                </div>
            </section>

            <!-- Demo 2: Game Prototype -->
            <section id="demo2" class="demo-section">
                <div class="demo-header">
                    <h1>PolarCraft æ¸¸æˆåŸå‹</h1>
                    <p class="subtitle">Interactive Game Demo - åæŒ¯å…‰è§£è°œæ¸¸æˆæœºåˆ¶</p>
                    <p>è¿™æ˜¯ PolarCraft æ¸¸æˆçš„æ ¸å¿ƒæœºåˆ¶æ¼”ç¤ºã€‚é€šè¿‡æ—‹è½¬åæŒ¯ç‰‡æ¥æ§åˆ¶å…‰çš„é€è¿‡ç‡ï¼Œè®©è¶³å¤Ÿçš„å…‰èƒ½é‡åˆ°è¾¾ä¼ æ„Ÿå™¨ä»¥å¼€å¯æœºå…³ã€‚è¿™å±•ç¤ºäº†å¦‚ä½•å°†ç‰©ç†åŸç†è½¬åŒ–ä¸ºæ¸¸æˆç©æ³•ã€‚</p>
                </div>
                <div class="demo-container">
                    <div class="demo-canvas-area" style="padding: 20px;">
                        <div id="game-proto" style="position: relative; width: 300px; height: 420px; background: #222; border: 2px solid #444; display: flex; flex-direction: column; align-items: center;">
                            <div style="position: absolute; top: 10px; left: 10px; font-size: 12px; color: #888;">å…‰å¼º: <span id="intensity2">100</span>%</div>
                            <div style="width: 20px; height: 20px; background: white; border-radius: 50%; margin-top: 20px; box-shadow: 0 0 20px white; z-index: 10;"></div>
                            <div id="beam2-1" style="position: absolute; top: 40px; width: 6px; height: 60px; background: linear-gradient(to bottom, rgba(255,255,255,0.8), rgba(255,255,255,0)); z-index: 1;"></div>
                            <div id="filter2-1" style="width: 100px; height: 100px; border: 4px solid #00d2ff; background: rgba(0, 210, 255, 0.1); position: absolute; top: 80px; display: flex; justify-content: center; align-items: center;">
                                <div style="width: 80%; height: 80%; background: repeating-linear-gradient(90deg, transparent, transparent 9px, rgba(0, 210, 255, 0.5) 10px);"></div>
                                <span style="position:absolute; color:#00d2ff; font-size:10px; background:#222;">å›ºå®š: 0Â°</span>
                            </div>
                            <div id="beam2-2" style="position: absolute; top: 180px; width: 6px; height: 60px; background: linear-gradient(to bottom, rgba(0,210,255,0.8), rgba(0,210,255,0)); z-index: 1;"></div>
                            <div id="filter2-2" style="width: 100px; height: 100px; border: 4px solid #ffcc00; background: rgba(255, 204, 0, 0.1); position: absolute; top: 220px; display: flex; justify-content: center; align-items: center; transition: transform 0.1s;">
                                <div style="width: 80%; height: 80%; background: repeating-linear-gradient(90deg, transparent, transparent 9px, rgba(255, 204, 0, 0.5) 10px);"></div>
                            </div>
                            <div id="beam2-3" style="position: absolute; top: 320px; width: 6px; height: 60px; background: linear-gradient(to bottom, rgba(255,204,0,0.8), rgba(255,204,0,0)); z-index: 1;"></div>
                            <div id="sensor2" style="position: absolute; bottom: 20px; width: 50px; height: 50px; background: #333; border: 2px solid #555; display: flex; justify-content: center; align-items: center; font-size: 28px; border-radius: 8px;">ğŸ”’</div>
                        </div>
                    </div>
                    <div class="demo-controls">
                        <div class="control-row">
                            <label>æ—‹è½¬ä¸‹æ–¹åæŒ¯ç‰‡:</label>
                            <input type="range" id="angle2" min="0" max="180" value="90">
                            <span class="value" id="angle2Val">90Â°</span>
                        </div>
                        <p id="status2" style="color: #ff5555; margin-top: 10px; text-align: center;">å…‰è·¯è¢«é˜»æ–­ï¼</p>
                    </div>
                </div>
                <div class="info-panel">
                    <h3>æ¸¸æˆæœºåˆ¶</h3>
                    <p><strong>ç›®æ ‡ï¼š</strong>è°ƒæ•´å¯æ—‹è½¬çš„åæŒ¯ç‰‡è§’åº¦ï¼Œä½¿è¶³å¤Ÿçš„å…‰èƒ½é‡ï¼ˆ>80%ï¼‰åˆ°è¾¾åº•éƒ¨çš„ä¼ æ„Ÿå™¨æ¥å¼€å¯æœºå…³ã€‚</p>
                    <p><strong>è§„åˆ™ï¼š</strong>ç¬¬ä¸€ä¸ªåæŒ¯ç‰‡å›ºå®šä¸º 0Â°ï¼ˆå‚ç›´åæŒ¯ï¼‰ï¼Œç¬¬äºŒä¸ªåæŒ¯ç‰‡å¯ä»¥æ—‹è½¬ã€‚å½“ä¸¤ä¸ªåæŒ¯ç‰‡çš„é€å…‰è½´å¤¹è§’æ¥è¿‘ 90Â° æ—¶ï¼Œå‡ ä¹æ²¡æœ‰å…‰èƒ½é€šè¿‡ï¼ˆæ¶ˆå…‰ï¼‰ã€‚</p>
                    <p>è¿™ä¸ªç®€å•çš„æœºåˆ¶å¯ä»¥æ‰©å±•ä¸ºæ›´å¤æ‚çš„è°œé¢˜ï¼ŒåŒ…æ‹¬å¤šä¸ªåæŒ¯ç‰‡ã€åˆ†æŸå™¨ã€æ³¢ç‰‡ç­‰å…‰å­¦å…ƒä»¶çš„ç»„åˆã€‚</p>
                </div>
            </section>

            <!-- Demo 3: Polarization States -->
            <section id="demo3" class="demo-section active">
                <div class="demo-header">
                    <h1>åæŒ¯æ€ä¸ç›¸ä½å·®</h1>
                    <p class="subtitle">Polarization States - çº¿åæŒ¯ã€åœ†åæŒ¯ä¸æ¤­åœ†åæŒ¯</p>
                    <p>å…‰çš„åæŒ¯çŠ¶æ€ç”±ä¸¤ä¸ªæ­£äº¤ç”µåœºåˆ†é‡çš„æŒ¯å¹…æ¯”å’Œç›¸ä½å·®å…±åŒå†³å®šã€‚é€šè¿‡è°ƒèŠ‚è¿™ä¸¤ä¸ªå‚æ•°ï¼Œå¯ä»¥äº§ç”Ÿçº¿åæŒ¯ã€åœ†åæŒ¯æˆ–æ¤­åœ†åæŒ¯å…‰ã€‚</p>
                </div>
                <div class="demo-container">
                    <div class="demo-canvas-area" style="flex-direction: row; gap: 30px; flex-wrap: wrap;">
                        <div style="text-align: center;">
                            <h4 style="color: #889; margin-bottom: 10px;">3D ç©ºé—´ä¼ æ’­è§†å›¾</h4>
                            <canvas id="canvas3-3d" width="500" height="280"></canvas>
                        </div>
                        <div style="text-align: center;">
                            <h4 style="color: #889; margin-bottom: 10px;">åæŒ¯æ€æŠ•å½±</h4>
                            <canvas id="canvas3-2d" width="280" height="280"></canvas>
                        </div>
                    </div>
                    <div class="demo-controls">
                        <div class="preset-buttons" style="margin-bottom: 20px;">
                            <button class="preset-btn" onclick="setDemo3Preset(0, 1, 0)">çº¿åæŒ¯ (æ°´å¹³)</button>
                            <button class="preset-btn" onclick="setDemo3Preset(0, 1, 1)">çº¿åæŒ¯ (45Â°)</button>
                            <button class="preset-btn" onclick="setDemo3Preset(90, 1, 1)">åœ†åæŒ¯</button>
                            <button class="preset-btn" onclick="setDemo3Preset(45, 1, 1)">æ¤­åœ†åæŒ¯</button>
                        </div>
                        <div class="control-row">
                            <label>ç›¸ä½å·® (Î´):</label>
                            <input type="range" id="phase3" min="0" max="360" value="0">
                            <span class="value" id="phase3Val">0Â°</span>
                        </div>
                        <div class="control-row">
                            <label>Ex æŒ¯å¹…:</label>
                            <input type="range" id="ampX3" min="0" max="100" value="100">
                            <span class="value" id="ampX3Val">1.0</span>
                        </div>
                        <div class="control-row">
                            <label>Ey æŒ¯å¹…:</label>
                            <input type="range" id="ampY3" min="0" max="100" value="100">
                            <span class="value" id="ampY3Val">1.0</span>
                        </div>
                    </div>
                </div>
                <div class="info-panel">
                    <h3>ç‰©ç†åŸç†</h3>
                    <p>å…‰æ³¢çš„ç”µåœºå¯ä»¥åˆ†è§£ä¸ºä¸¤ä¸ªäº’ç›¸å‚ç›´çš„åˆ†é‡ Ex å’Œ Eyã€‚åæŒ¯æ€å–å†³äºï¼š</p>
                    <p><strong>1. çº¿åæŒ¯ï¼š</strong>å½“ç›¸ä½å·® Î´ = 0Â° æˆ– 180Â° æ—¶ï¼Œåˆæˆç”µåœºçŸ¢é‡åœ¨ä¸€æ¡ç›´çº¿ä¸ŠæŒ¯åŠ¨ã€‚</p>
                    <p><strong>2. åœ†åæŒ¯ï¼š</strong>å½“ Î´ = 90Â° ä¸” Ex = Ey æ—¶ï¼Œç”µåœºçŸ¢é‡ç«¯ç‚¹æç»˜å‡ºä¸€ä¸ªåœ†ã€‚</p>
                    <p><strong>3. æ¤­åœ†åæŒ¯ï¼š</strong>ä¸€èˆ¬æƒ…å†µä¸‹ï¼Œç”µåœºçŸ¢é‡ç«¯ç‚¹æç»˜å‡ºä¸€ä¸ªæ¤­åœ†ã€‚</p>
                    <div class="legend">
                        <div class="legend-item"><div class="legend-color" style="background:#ff4444;"></div>Ex (æ°´å¹³åˆ†é‡)</div>
                        <div class="legend-item"><div class="legend-color" style="background:#44ff44;"></div>Ey (å‚ç›´åˆ†é‡)</div>
                        <div class="legend-item"><div class="legend-color" style="background:#ffff00;"></div>E (åˆæˆçŸ¢é‡)</div>
                    </div>
                    <div class="status-display">
                        <div class="status-item">
                            <div class="label">å½“å‰åæŒ¯æ€</div>
                            <div class="value" id="state3" style="font-size: 16px;">çº¿åæŒ¯</div>
                        </div>
                    </div>
                </div>
            </section>

            <!-- Demo 4: Birefringence -->
            <section id="demo4" class="demo-section">
                <div class="demo-header">
                    <h1>åŒæŠ˜å°„æ™¶ä½“</h1>
                    <p class="subtitle">Birefringence - æ–¹è§£çŸ³ç­‰æ™¶ä½“çš„åŒæŠ˜å°„ç°è±¡</p>
                    <p>æŸäº›å„å‘å¼‚æ€§æ™¶ä½“ï¼ˆå¦‚æ–¹è§£çŸ³ï¼‰å…·æœ‰åŒæŠ˜å°„ç‰¹æ€§ï¼šä¸€æŸå…‰è¿›å…¥æ™¶ä½“åä¼šåˆ†è£‚æˆä¸¤æŸåæŒ¯æ–¹å‘äº’ç›¸å‚ç›´çš„å…‰â€”â€”å¯»å¸¸å…‰ï¼ˆoå…‰ï¼‰å’Œéå¯»å¸¸å…‰ï¼ˆeå…‰ï¼‰ã€‚</p>
                </div>
                <div class="demo-container">
                    <div class="demo-canvas-area">
                        <canvas id="canvas4" width="600" height="350"></canvas>
                    </div>
                    <div class="demo-controls">
                        <div class="control-row">
                            <label>å…¥å°„å…‰åæŒ¯è§’åº¦:</label>
                            <input type="range" id="inAngle4" min="0" max="90" value="45">
                            <span class="value" id="inAngle4Val">45Â°</span>
                        </div>
                        <div class="control-row">
                            <label>æ™¶ä½“å…‰è½´æ–¹å‘:</label>
                            <input type="range" id="axisAngle4" min="0" max="90" value="0">
                            <span class="value" id="axisAngle4Val">0Â°</span>
                        </div>
                    </div>
                </div>
                <div class="info-panel">
                    <h3>ç‰©ç†åŸç†</h3>
                    <p><strong>åŒæŠ˜å°„</strong>æ˜¯å„å‘å¼‚æ€§æ™¶ä½“çš„å…‰å­¦ç‰¹æ€§ã€‚è¿›å…¥æ™¶ä½“çš„å…‰è¢«åˆ†è§£ä¸ºï¼š</p>
                    <p><strong>oå…‰ï¼ˆå¯»å¸¸å…‰ï¼‰ï¼š</strong>åæŒ¯æ–¹å‘å‚ç›´äºå…‰è½´æ‰€åœ¨å¹³é¢ï¼Œéµå¾ªæ™®é€šæŠ˜å°„å®šå¾‹ï¼ŒæŠ˜å°„ç‡ä¸º n<sub>o</sub>ã€‚</p>
                    <p><strong>eå…‰ï¼ˆéå¯»å¸¸å…‰ï¼‰ï¼š</strong>åæŒ¯æ–¹å‘åœ¨å…‰è½´æ‰€åœ¨å¹³é¢å†…ï¼ŒæŠ˜å°„ç‡ n<sub>e</sub> éšä¼ æ’­æ–¹å‘å˜åŒ–ã€‚</p>
                    <div class="formula">åˆ†å…‰æ¯”ä¾‹ï¼šI<sub>o</sub> = I<sub>0</sub>sinÂ²(Î¸), I<sub>e</sub> = I<sub>0</sub>cosÂ²(Î¸)</div>
                    <p>å½“å…¥å°„å…‰åæŒ¯è§’ä¸º 45Â° æ—¶ï¼Œä¸¤æŸå…‰å¼ºåº¦ç›¸ç­‰ã€‚å½“åæŒ¯è§’ä¸º 0Â° æˆ– 90Â° æ—¶ï¼Œåªæœ‰ä¸€æŸå…‰å‡ºå°„ã€‚</p>
                    <div class="legend">
                        <div class="legend-item"><div class="legend-color" style="background:#00ff88;"></div>oå…‰ (å¯»å¸¸å…‰)</div>
                        <div class="legend-item"><div class="legend-color" style="background:#ff8800;"></div>eå…‰ (éå¯»å¸¸å…‰)</div>
                    </div>
                    <div class="status-display">
                        <div class="status-item">
                            <div class="label">oå…‰å¼ºåº¦</div>
                            <div class="value" id="oIntensity4">50%</div>
                        </div>
                        <div class="status-item">
                            <div class="label">eå…‰å¼ºåº¦</div>
                            <div class="value" id="eIntensity4">50%</div>
                        </div>
                    </div>
                </div>
            </section>

            <!-- Demo 5: Wave Plates -->
            <section id="demo5" class="demo-section">
                <div class="demo-header">
                    <h1>æ³¢ç‰‡æ•ˆåº”</h1>
                    <p class="subtitle">Wave Plates - Î»/4 å’Œ Î»/2 æ³¢ç‰‡çš„ä½œç”¨</p>
                    <p>æ³¢ç‰‡æ˜¯ä¸€ç§å…‰å­¦å…ƒä»¶ï¼Œåˆ©ç”¨åŒæŠ˜å°„æ•ˆåº”åœ¨å¿«è½´å’Œæ…¢è½´æ–¹å‘ä¸Šäº§ç”Ÿç‰¹å®šçš„ç›¸ä½å»¶è¿Ÿï¼Œä»è€Œæ”¹å˜å…‰çš„åæŒ¯çŠ¶æ€ã€‚</p>
                </div>
                <div class="demo-container">
                    <div class="demo-canvas-area" style="flex-direction: row; gap: 40px; flex-wrap: wrap;">
                        <div style="text-align: center;">
                            <h4 style="color: #889; margin-bottom: 10px;">å…¥å°„åæŒ¯æ€</h4>
                            <canvas id="canvas5-in" width="200" height="200"></canvas>
                        </div>
                        <div style="text-align: center; display: flex; flex-direction: column; align-items: center; justify-content: center;">
                            <div style="font-size: 40px; color: #64c8ff;">â†’</div>
                            <div id="waveplate5" style="width: 80px; height: 120px; border: 3px solid #64c8ff; border-radius: 8px; background: rgba(100, 200, 255, 0.1); display: flex; align-items: center; justify-content: center; font-size: 14px; color: #64c8ff;">Î»/4</div>
                            <div style="font-size: 40px; color: #64c8ff;">â†’</div>
                        </div>
                        <div style="text-align: center;">
                            <h4 style="color: #889; margin-bottom: 10px;">å‡ºå°„åæŒ¯æ€</h4>
                            <canvas id="canvas5-out" width="200" height="200"></canvas>
                        </div>
                    </div>
                    <div class="demo-controls">
                        <div class="preset-buttons" style="margin-bottom: 20px;">
                            <button class="preset-btn" onclick="setDemo5Preset('quarter')">Î»/4 æ³¢ç‰‡</button>
                            <button class="preset-btn" onclick="setDemo5Preset('half')">Î»/2 æ³¢ç‰‡</button>
                            <button class="preset-btn" onclick="setDemo5Preset('full')">Î» æ³¢ç‰‡</button>
                        </div>
                        <div class="control-row">
                            <label>æ³¢ç‰‡ç›¸ä½å»¶è¿Ÿ:</label>
                            <input type="range" id="retard5" min="0" max="360" value="90">
                            <span class="value" id="retard5Val">90Â° (Î»/4)</span>
                        </div>
                        <div class="control-row">
                            <label>å…¥å°„åæŒ¯è§’:</label>
                            <input type="range" id="inPol5" min="0" max="90" value="45">
                            <span class="value" id="inPol5Val">45Â°</span>
                        </div>
                        <div class="control-row">
                            <label>æ³¢ç‰‡å¿«è½´è§’åº¦:</label>
                            <input type="range" id="fastAxis5" min="0" max="90" value="0">
                            <span class="value" id="fastAxis5Val">0Â°</span>
                        </div>
                    </div>
                </div>
                <div class="info-panel">
                    <h3>ç‰©ç†åŸç†</h3>
                    <p>æ³¢ç‰‡åˆ©ç”¨åŒæŠ˜å°„ææ–™åˆ¶æˆï¼Œå¿«è½´æ–¹å‘çš„å…‰æ¯”æ…¢è½´æ–¹å‘çš„å…‰ä¼ æ’­æ›´å¿«ï¼Œäº§ç”Ÿç›¸ä½å·®ï¼š</p>
                    <div class="formula">Î´ = (2Ï€/Î») Ã— (n<sub>e</sub> - n<sub>o</sub>) Ã— d</div>
                    <p><strong>Î»/4 æ³¢ç‰‡ï¼ˆÎ´ = 90Â°ï¼‰ï¼š</strong>å°† 45Â° çº¿åæŒ¯å…‰è½¬æ¢ä¸ºåœ†åæŒ¯å…‰ï¼Œæˆ–å°†åœ†åæŒ¯å…‰è½¬æ¢ä¸ºçº¿åæŒ¯å…‰ã€‚</p>
                    <p><strong>Î»/2 æ³¢ç‰‡ï¼ˆÎ´ = 180Â°ï¼‰ï¼š</strong>å°†çº¿åæŒ¯å…‰çš„åæŒ¯æ–¹å‘æ—‹è½¬ 2Î¸ï¼ˆÎ¸ ä¸ºåæŒ¯æ–¹å‘ä¸å¿«è½´çš„å¤¹è§’ï¼‰ã€‚</p>
                    <div class="status-display">
                        <div class="status-item">
                            <div class="label">å…¥å°„æ€</div>
                            <div class="value" id="inState5" style="font-size: 14px;">çº¿åæŒ¯</div>
                        </div>
                        <div class="status-item">
                            <div class="label">å‡ºå°„æ€</div>
                            <div class="value" id="outState5" style="font-size: 14px;">åœ†åæŒ¯</div>
                        </div>
                    </div>
                </div>
            </section>

            <!-- Demo 6: Brewster's Angle -->
            <section id="demo6" class="demo-section">
                <div class="demo-header">
                    <h1>å¸ƒå„’æ–¯ç‰¹è§’</h1>
                    <p class="subtitle">Brewster's Angle - åå°„å…‰çš„å®Œå…¨åæŒ¯åŒ–</p>
                    <p>å½“å…‰ä»¥ç‰¹å®šè§’åº¦ï¼ˆå¸ƒå„’æ–¯ç‰¹è§’ï¼‰å…¥å°„åˆ°ä¸¤ç§ä»‹è´¨çš„ç•Œé¢æ—¶ï¼Œåå°„å…‰å°†å®Œå…¨åæŒ¯åŒ–ï¼ŒåæŒ¯æ–¹å‘å‚ç›´äºå…¥å°„é¢ã€‚</p>
                </div>
                <div class="demo-container">
                    <div class="demo-canvas-area">
                        <canvas id="canvas6" width="600" height="400"></canvas>
                    </div>
                    <div class="demo-controls">
                        <div class="control-row">
                            <label>å…¥å°„è§’:</label>
                            <input type="range" id="incAngle6" min="0" max="89" value="56">
                            <span class="value" id="incAngle6Val">56Â°</span>
                        </div>
                        <div class="control-row">
                            <label>ä»‹è´¨æŠ˜å°„ç‡ (nâ‚‚):</label>
                            <input type="range" id="n2_6" min="100" max="200" value="150">
                            <span class="value" id="n2Val6">1.50</span>
                        </div>
                    </div>
                </div>
                <div class="info-panel">
                    <h3>ç‰©ç†åŸç†</h3>
                    <div class="formula">tan(Î¸<sub>B</sub>) = nâ‚‚ / nâ‚</div>
                    <p><strong>å¸ƒå„’æ–¯ç‰¹å®šå¾‹ï¼š</strong>å½“å…¥å°„è§’ç­‰äºå¸ƒå„’æ–¯ç‰¹è§’ Î¸<sub>B</sub> æ—¶ï¼Œåå°„å…‰å’ŒæŠ˜å°„å…‰äº’ç›¸å‚ç›´ï¼Œæ­¤æ—¶ p åæŒ¯åˆ†é‡ï¼ˆå¹³è¡Œäºå…¥å°„é¢ï¼‰çš„åå°„ç‡ä¸ºé›¶ï¼Œåå°„å…‰å®Œå…¨ç”± s åæŒ¯åˆ†é‡ï¼ˆå‚ç›´äºå…¥å°„é¢ï¼‰ç»„æˆã€‚</p>
                    <p>å¯¹äºç©ºæ°”-ç»ç’ƒç•Œé¢ï¼ˆn = 1.5ï¼‰ï¼Œå¸ƒå„’æ–¯ç‰¹è§’çº¦ä¸º 56.3Â°ã€‚è¿™ä¸€åŸç†è¢«å¹¿æ³›åº”ç”¨äºåæŒ¯å™¨è®¾è®¡ã€å‡å°‘åå°„æŸè€—ç­‰é¢†åŸŸã€‚</p>
                    <div class="legend">
                        <div class="legend-item"><div class="legend-color" style="background:#ff6666;"></div>p åæŒ¯ (å¹³è¡Œå…¥å°„é¢)</div>
                        <div class="legend-item"><div class="legend-color" style="background:#6666ff;"></div>s åæŒ¯ (å‚ç›´å…¥å°„é¢)</div>
                    </div>
                    <div class="status-display">
                        <div class="status-item">
                            <div class="label">å¸ƒå„’æ–¯ç‰¹è§’</div>
                            <div class="value" id="brewster6">56.3Â°</div>
                        </div>
                        <div class="status-item">
                            <div class="label">påå°„ç‡</div>
                            <div class="value" id="rp6">0%</div>
                        </div>
                        <div class="status-item">
                            <div class="label">såå°„ç‡</div>
                            <div class="value" id="rs6">14%</div>
                        </div>
                    </div>
                </div>
            </section>

            <!-- Demo 7: Interference -->
            <section id="demo7" class="demo-section">
                <div class="demo-header">
                    <h1>è‰²åæŒ¯ä¸å¹²æ¶‰</h1>
                    <p class="subtitle">Chromatic Polarization - åŒæŠ˜å°„ä»‹è´¨çš„å½©è‰²æ•ˆåº”</p>
                    <p>å½“ç™½å…‰é€šè¿‡åŒæŠ˜å°„ä»‹è´¨å¹¶ç»è¿‡æ£€åå™¨æ—¶ï¼Œç”±äºä¸åŒæ³¢é•¿çš„å…‰ç»å†ä¸åŒçš„ç›¸ä½å»¶è¿Ÿï¼Œä¼šäº§ç”Ÿç¾ä¸½çš„å¹²æ¶‰è‰²å½©ã€‚è¿™å°±æ˜¯è‰²åæŒ¯ç°è±¡ï¼Œå¹¿æ³›åº”ç”¨äºåº”åŠ›åˆ†æã€ææ–™æ£€æµ‹ç­‰é¢†åŸŸã€‚</p>
                </div>
                <div class="demo-container">
                    <div class="demo-canvas-area">
                        <canvas id="canvas7" width="600" height="350"></canvas>
                    </div>
                    <div class="demo-controls">
                        <div class="control-row">
                            <label>å…‰æŸ1åæŒ¯è§’:</label>
                            <input type="range" id="pol7a" min="0" max="180" value="0">
                            <span class="value" id="pol7aVal">0Â°</span>
                        </div>
                        <div class="control-row">
                            <label>å…‰æŸ2åæŒ¯è§’:</label>
                            <input type="range" id="pol7b" min="0" max="180" value="0">
                            <span class="value" id="pol7bVal">0Â°</span>
                        </div>
                        <div class="control-row">
                            <label>ç›¸ä½å·®:</label>
                            <input type="range" id="phase7" min="0" max="360" value="0">
                            <span class="value" id="phase7Val">0Â°</span>
                        </div>
                        <div class="control-row">
                            <label>æŒ¯å¹…æ¯” (Aâ‚‚/Aâ‚):</label>
                            <input type="range" id="ampRatio7" min="0" max="100" value="100">
                            <span class="value" id="ampRatio7Val">1.0</span>
                        </div>
                    </div>
                </div>
                <div class="info-panel">
                    <h3>ç‰©ç†åŸç†</h3>
                    <p><strong>å¹²æ¶‰æ¡ä»¶ï¼š</strong>åªæœ‰åæŒ¯æ–¹å‘æœ‰å¹³è¡Œåˆ†é‡çš„å…‰æ‰èƒ½å‘ç”Ÿå¹²æ¶‰ã€‚ä¸¤æŸæ­£äº¤åæŒ¯çš„å…‰ä¸ä¼šäº§ç”Ÿå¹²æ¶‰æ¡çº¹ã€‚</p>
                    <div class="formula">I = Iâ‚ + Iâ‚‚ + 2âˆš(Iâ‚Iâ‚‚) cos(Î”Ï†) cosÂ²(Î¸â‚â‚‚/2)</div>
                    <p>å…¶ä¸­ Î¸â‚â‚‚ æ˜¯ä¸¤æŸå…‰åæŒ¯æ–¹å‘çš„å¤¹è§’ï¼ŒÎ”Ï† æ˜¯ç›¸ä½å·®ã€‚</p>
                    <p><strong>ç›¸é•¿å¹²æ¶‰ï¼š</strong>ç›¸ä½å·® Î”Ï† = 0Â°, 360Â°... æ—¶ï¼Œå…‰å¼ºæœ€å¤§ã€‚</p>
                    <p><strong>ç›¸æ¶ˆå¹²æ¶‰ï¼š</strong>ç›¸ä½å·® Î”Ï† = 180Â° æ—¶ï¼Œè‹¥æŒ¯å¹…ç›¸ç­‰åˆ™å…‰å¼ºä¸ºé›¶ã€‚</p>
                    <div class="status-display">
                        <div class="status-item">
                            <div class="label">å¹²æ¶‰ç±»å‹</div>
                            <div class="value" id="intType7" style="font-size: 14px;">ç›¸é•¿å¹²æ¶‰</div>
                        </div>
                        <div class="status-item">
                            <div class="label">åˆæˆå…‰å¼º</div>
                            <div class="value" id="resultI7">200%</div>
                        </div>
                    </div>
                </div>
            </section>

            <!-- Demo 8: Optical Activity -->
            <section id="demo8" class="demo-section">
                <div class="demo-header">
                    <h1>æ—‹å…‰æ€§</h1>
                    <p class="subtitle">Optical Activity - æ‰‹æ€§åˆ†å­å¯¹åæŒ¯é¢çš„æ—‹è½¬</p>
                    <p>æŸäº›ç‰©è´¨ï¼ˆå¦‚ç³–æº¶æ¶²ã€çŸ³è‹±æ™¶ä½“ï¼‰èƒ½å¤Ÿæ—‹è½¬é€šè¿‡å®ƒçš„çº¿åæŒ¯å…‰çš„åæŒ¯æ–¹å‘ã€‚æ—‹è½¬è§’åº¦ä¸ç‰©è´¨çš„æµ“åº¦å’Œå…‰ç¨‹é•¿åº¦æˆæ­£æ¯”ã€‚</p>
                </div>
                <div class="demo-container">
                    <div class="demo-canvas-area">
                        <canvas id="canvas8" width="600" height="320"></canvas>
                    </div>
                    <div class="demo-controls">
                        <div class="preset-buttons" style="margin-bottom: 20px;">
                            <button class="preset-btn" onclick="setDemo8Preset('sugar')">è”—ç³–æº¶æ¶²</button>
                            <button class="preset-btn" onclick="setDemo8Preset('quartz')">çŸ³è‹±æ™¶ä½“</button>
                            <button class="preset-btn" onclick="setDemo8Preset('fructose')">æœç³–æº¶æ¶² (å·¦æ—‹)</button>
                        </div>
                        <div class="control-row">
                            <label>æº¶æ¶²æµ“åº¦ (g/mL):</label>
                            <input type="range" id="conc8" min="0" max="100" value="50">
                            <span class="value" id="conc8Val">0.50</span>
                        </div>
                        <div class="control-row">
                            <label>å…‰ç¨‹é•¿åº¦ (dm):</label>
                            <input type="range" id="path8" min="1" max="20" value="10">
                            <span class="value" id="path8Val">1.0</span>
                        </div>
                        <div class="control-row">
                            <label>æ—‹å…‰ç‡ [Î±] (Â°/dmÂ·g/mL):</label>
                            <input type="range" id="alpha8" min="-100" max="100" value="66">
                            <span class="value" id="alpha8Val">+66.5</span>
                        </div>
                    </div>
                </div>
                <div class="info-panel">
                    <h3>ç‰©ç†åŸç†</h3>
                    <div class="formula">Î± = [Î±] Ã— c Ã— l</div>
                    <p>æ—‹å…‰è§’ Î± ç­‰äºæ¯”æ—‹å…‰åº¦ [Î±] ä¹˜ä»¥æµ“åº¦ c å’Œå…‰ç¨‹é•¿åº¦ lã€‚</p>
                    <p><strong>å³æ—‹ç‰©è´¨ï¼ˆ+ï¼‰ï¼š</strong>ä»å…‰ä¼ æ’­æ–¹å‘çœ‹ï¼ŒåæŒ¯é¢é¡ºæ—¶é’ˆæ—‹è½¬ã€‚å¦‚è”—ç³–ï¼ˆ[Î±] = +66.5Â°ï¼‰ã€‚</p>
                    <p><strong>å·¦æ—‹ç‰©è´¨ï¼ˆ-ï¼‰ï¼š</strong>ä»å…‰ä¼ æ’­æ–¹å‘çœ‹ï¼ŒåæŒ¯é¢é€†æ—¶é’ˆæ—‹è½¬ã€‚å¦‚æœç³–ï¼ˆ[Î±] = -92Â°ï¼‰ã€‚</p>
                    <p>æ—‹å…‰æ€§æºäºåˆ†å­çš„æ‰‹æ€§ç»“æ„ï¼Œæ˜¯ç³–åº¦è®¡ã€åå…‰æ˜¾å¾®é•œç­‰ä»ªå™¨çš„å·¥ä½œåŸç†åŸºç¡€ã€‚</p>
                    <div class="status-display">
                        <div class="status-item">
                            <div class="label">æ—‹è½¬è§’åº¦</div>
                            <div class="value" id="rotation8">+33.3Â°</div>
                        </div>
                        <div class="status-item">
                            <div class="label">æ—‹è½¬æ–¹å‘</div>
                            <div class="value" id="direction8" style="font-size: 14px;">å³æ—‹</div>
                        </div>
                    </div>
                </div>
            </section>

            <!-- Demo 9: Photoelasticity -->
            <section id="demo9" class="demo-section">
                <div class="demo-header">
                    <h1>å…‰å¼¹æ€§æ•ˆåº”</h1>
                    <p class="subtitle">Photoelasticity - åº”åŠ›åŒæŠ˜å°„å¯è§†åŒ–</p>
                    <p>é€æ˜ææ–™åœ¨åº”åŠ›ä½œç”¨ä¸‹ä¼šäº§ç”ŸåŒæŠ˜å°„ï¼Œå½“ç½®äºæ­£äº¤åæŒ¯ç‰‡ä¹‹é—´æ—¶ï¼Œåº”åŠ›åˆ†å¸ƒä¼šå½¢æˆå½©è‰²å¹²æ¶‰æ¡çº¹ï¼Œè¿™æ˜¯å…‰å¼¹æ€§åˆ†æçš„åŸºç¡€ã€‚</p>
                </div>
                <div class="demo-container">
                    <div class="demo-canvas-area">
                        <canvas id="canvas9" width="500" height="400"></canvas>
                    </div>
                    <div class="demo-controls">
                        <div class="preset-buttons" style="margin-bottom: 20px;">
                            <button class="preset-btn" onclick="setDemo9Preset('point')">ç‚¹è½½è·</button>
                            <button class="preset-btn" onclick="setDemo9Preset('tension')">æ‹‰ä¼¸åº”åŠ›</button>
                            <button class="preset-btn" onclick="setDemo9Preset('bend')">å¼¯æ›²åº”åŠ›</button>
                            <button class="preset-btn" onclick="setDemo9Preset('hole')">åœ†å­”åº”åŠ›é›†ä¸­</button>
                        </div>
                        <div class="control-row">
                            <label>åº”åŠ›å¤§å°:</label>
                            <input type="range" id="stress9" min="0" max="100" value="50">
                            <span class="value" id="stress9Val">50%</span>
                        </div>
                        <div class="control-row">
                            <label>æ£€åå™¨è§’åº¦:</label>
                            <input type="range" id="analyzerAngle9" min="0" max="90" value="90">
                            <span class="value" id="analyzerAngle9Val">90Â°</span>
                        </div>
                    </div>
                </div>
                <div class="info-panel">
                    <h3>ç‰©ç†åŸç†</h3>
                    <p><strong>åº”åŠ›-å…‰å­¦å®šå¾‹ï¼š</strong>ææ–™åœ¨åº”åŠ›ä½œç”¨ä¸‹äº§ç”Ÿçš„åŒæŠ˜å°„é‡ä¸åº”åŠ›å·®æˆæ­£æ¯”ï¼š</p>
                    <div class="formula">Î”n = C Ã— (Ïƒâ‚ - Ïƒâ‚‚)</div>
                    <p>å…¶ä¸­ C æ˜¯åº”åŠ›-å…‰å­¦ç³»æ•°ï¼ŒÏƒâ‚ å’Œ Ïƒâ‚‚ æ˜¯ä¸»åº”åŠ›ã€‚</p>
                    <p><strong>ç­‰è‰²çº¿ï¼ˆIsochromaticï¼‰ï¼š</strong>ç›¸åŒé¢œè‰²çš„çº¿è¿æ¥äº†ä¸»åº”åŠ›å·®ç›¸ç­‰çš„ç‚¹ã€‚</p>
                    <p><strong>ç­‰å€¾çº¿ï¼ˆIsoclinicï¼‰ï¼š</strong>é»‘è‰²æ¡çº¹å‡ºç°åœ¨ä¸»åº”åŠ›æ–¹å‘ä¸åæŒ¯å™¨è½´å¹³è¡Œæˆ–å‚ç›´çš„ä½ç½®ã€‚</p>
                    <p>å…‰å¼¹æ€§åˆ†æè¢«å¹¿æ³›åº”ç”¨äºå·¥ç¨‹ç»“æ„åº”åŠ›åˆ†æã€æ–­è£‚åŠ›å­¦ç ”ç©¶ç­‰é¢†åŸŸã€‚</p>
                </div>
            </section>

            <!-- Demo 10: Scattering -->
            <section id="demo10" class="demo-section">
                <div class="demo-header">
                    <h1>ç‘åˆ©ä¸ç±³æ°æ•£å°„</h1>
                    <p class="subtitle">Rayleigh & Mie Scattering - é¢—ç²’ç‰©æ•£å°„çš„å…‰è°±ä¸åæŒ¯ç‰¹å¾</p>
                    <p>å…‰è¢«é¢—ç²’ç‰©æ•£å°„æ—¶ï¼Œæ•£å°„å¼ºåº¦å’ŒåæŒ¯ç‰¹å¾ä¸é¢—ç²’ç‰©çš„ç²’å¾„ã€å½¢çŠ¶å’ŒæŠ˜å°„ç‡å¯†åˆ‡ç›¸å…³ã€‚ç‘åˆ©æ•£å°„è§£é‡Šè“å¤©ï¼Œç±³æ°æ•£å°„è§£é‡Šç™½äº‘å’Œçº¢éœã€‚</p>
                </div>
                <div class="demo-container">
                    <div class="demo-canvas-area">
                        <canvas id="canvas10" width="700" height="400"></canvas>
                    </div>
                    <div class="demo-controls">
                        <div class="control-row">
                            <label>é¢—ç²’ç²’å¾„ (nm):</label>
                            <input type="range" id="particleSize10" min="10" max="2000" value="100" step="10">
                            <span class="value" id="particleSize10Val">100nm</span>
                        </div>
                        <div class="control-row">
                            <label>è§‚å¯Ÿè§’åº¦:</label>
                            <input type="range" id="observeAngle10" min="0" max="180" value="90">
                            <span class="value" id="observeAngle10Val">90Â°</span>
                        </div>
                        <div class="control-row">
                            <label style="min-width: 140px;">å¿«é€Ÿé¢„è®¾:</label>
                            <div class="preset-buttons">
                                <button class="preset-btn" onclick="setScatterPreset('sky')">è“å¤© (ç‘åˆ©)</button>
                                <button class="preset-btn" onclick="setScatterPreset('cloud')">ç™½äº‘ (ç±³æ°)</button>
                                <button class="preset-btn" onclick="setScatterPreset('sunset')">çº¢éœ</button>
                                <button class="preset-btn" onclick="setScatterPreset('milk')">ç‰›å¥¶æ•£å°„</button>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="info-panel">
                    <h3>ç‰©ç†åŸç†</h3>
                    <p><strong>ç‘åˆ©æ•£å°„ï¼ˆRayleigh Scatteringï¼‰ï¼š</strong>å½“é¢—ç²’ç²’å¾„è¿œå°äºå…‰æ³¢é•¿æ—¶ï¼ˆd << Î»ï¼‰ï¼Œæ•£å°„å¼ºåº¦ä¸æ³¢é•¿çš„å››æ¬¡æ–¹æˆåæ¯”ï¼š</p>
                    <div class="formula">I âˆ 1/Î»â´</div>
                    <p>è¿™è§£é‡Šäº†ä¸ºä»€ä¹ˆå¤©ç©ºæ˜¯è“è‰²çš„â€”â€”çŸ­æ³¢é•¿ï¼ˆè“å…‰ï¼‰æ¯”é•¿æ³¢é•¿ï¼ˆçº¢å…‰ï¼‰æ•£å°„æ›´å¼ºã€‚</p>
                    <p><strong>ç±³æ°æ•£å°„ï¼ˆMie Scatteringï¼‰ï¼š</strong>å½“é¢—ç²’ç²’å¾„ä¸å…‰æ³¢é•¿ç›¸å½“æ—¶ï¼ˆd â‰ˆ Î»ï¼‰ï¼Œæ•£å°„å˜å¾—å¤æ‚ï¼Œå„æ³¢é•¿æ•£å°„æ¥è¿‘ï¼Œå› æ­¤äº‘å‘ˆç°ç™½è‰²ã€‚</p>
                    <p><strong>æ•£å°„åæŒ¯ï¼š</strong>ä¾§å‘æ•£å°„å…‰ï¼ˆ90Â°ï¼‰åæŒ¯åº¦æœ€é«˜ï¼Œå‰å‘å’Œåå‘æ•£å°„åæŒ¯åº¦è¾ƒä½ã€‚</p>
                    <div class="status-display">
                        <div class="status-item">
                            <div class="label">æ•£å°„ç±»å‹</div>
                            <div class="value" id="scatterType10">ç‘åˆ©æ•£å°„</div>
                        </div>
                        <div class="status-item">
                            <div class="label">åæŒ¯åº¦</div>
                            <div class="value" id="polarDegree10">85%</div>
                        </div>
                    </div>
                </div>
            </section>

            <!-- Demo 11: Mueller Matrix -->
            <section id="demo11" class="demo-section">
                <div class="demo-header">
                    <h1>StokesçŸ¢é‡ä¸MuellerçŸ©é˜µ</h1>
                    <p class="subtitle">Full Polarimetry - åæŒ¯å…‰å­¦çš„å®Œå¤‡è¡¨å¾</p>
                    <p>StokesçŸ¢é‡å®Œæ•´æè¿°å…‰çš„åæŒ¯æ€ï¼ŒMuellerçŸ©é˜µå®Œæ•´æè¿°å…‰å­¦å…ƒä»¶å¯¹åæŒ¯æ€çš„å˜æ¢ã€‚ä¸¤è€…ç»“åˆæ„æˆå…¨åæŒ¯å…‰å­¦æµ‹é‡çš„æ•°å­¦åŸºç¡€ã€‚</p>
                </div>
                <div class="demo-container">
                    <div class="demo-canvas-area">
                        <canvas id="canvas11" width="700" height="450"></canvas>
                    </div>
                    <div class="demo-controls">
                        <div class="control-row">
                            <label>å…¥å°„å…‰ç±»å‹:</label>
                            <div class="preset-buttons">
                                <button class="preset-btn" onclick="setStokesInput('horizontal')">æ°´å¹³åæŒ¯</button>
                                <button class="preset-btn" onclick="setStokesInput('vertical')">å‚ç›´åæŒ¯</button>
                                <button class="preset-btn" onclick="setStokesInput('diagonal')">45Â°åæŒ¯</button>
                                <button class="preset-btn" onclick="setStokesInput('circular_r')">å³æ—‹åœ†åæŒ¯</button>
                                <button class="preset-btn" onclick="setStokesInput('circular_l')">å·¦æ—‹åœ†åæŒ¯</button>
                            </div>
                        </div>
                        <div class="control-row">
                            <label>å…‰å­¦å…ƒä»¶:</label>
                            <div class="preset-buttons">
                                <button class="preset-btn" onclick="setMuellerElement('polarizer_h')">æ°´å¹³åæŒ¯ç‰‡</button>
                                <button class="preset-btn" onclick="setMuellerElement('polarizer_45')">45Â°åæŒ¯ç‰‡</button>
                                <button class="preset-btn" onclick="setMuellerElement('qwp')">å››åˆ†ä¹‹ä¸€æ³¢ç‰‡</button>
                                <button class="preset-btn" onclick="setMuellerElement('hwp')">äºŒåˆ†ä¹‹ä¸€æ³¢ç‰‡</button>
                                <button class="preset-btn" onclick="setMuellerElement('depolarizer')">é€€åå™¨</button>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="info-panel">
                    <h3>ç‰©ç†åŸç†</h3>
                    <p><strong>StokesçŸ¢é‡ï¼š</strong>ç”¨å››ä¸ªå¯æµ‹é‡çš„å‚æ•°å®Œæ•´æè¿°å…‰çš„åæŒ¯æ€ï¼š</p>
                    <div class="formula">S = [Sâ‚€, Sâ‚, Sâ‚‚, Sâ‚ƒ]áµ€</div>
                    <ul style="margin: 15px 0; padding-left: 20px; color: #aab;">
                        <li>Sâ‚€: æ€»å…‰å¼º</li>
                        <li>Sâ‚: æ°´å¹³åæŒ¯ - å‚ç›´åæŒ¯</li>
                        <li>Sâ‚‚: +45Â°åæŒ¯ - -45Â°åæŒ¯</li>
                        <li>Sâ‚ƒ: å³æ—‹åœ†åæŒ¯ - å·¦æ—‹åœ†åæŒ¯</li>
                    </ul>
                    <p><strong>MuellerçŸ©é˜µï¼š</strong>4Ã—4çŸ©é˜µï¼Œå®Œæ•´æè¿°å…‰å­¦å…ƒä»¶å¯¹åæŒ¯æ€çš„å˜æ¢ï¼š</p>
                    <div class="formula">S' = M Â· S</div>
                    <p>MuellerçŸ©é˜µæ˜¯æ ·æœ¬åæŒ¯å…‰å­¦ç‰¹å¾çš„å®Œå¤‡è¡¨å¾ï¼ŒåŒ…å«æå…¶ä¸°å¯Œçš„å…‰å­¦æ€§è´¨å’Œå¾®è§‚ç»“æ„å‡ ä½•ç‰¹å¾ä¿¡æ¯ï¼Œåœ¨æµ·æ´‹æ¢æµ‹ã€ç”Ÿç‰©åŒ»å­¦ã€ææ–™æ£€æµ‹ã€è‡ªåŠ¨é©¾é©¶ç­‰é¢†åŸŸæœ‰å¹¿æ³›åº”ç”¨ã€‚</p>
                    <div class="status-display">
                        <div class="status-item">
                            <div class="label">å…¥å°„Stokes</div>
                            <div class="value" id="stokesIn11">[1,1,0,0]</div>
                        </div>
                        <div class="status-item">
                            <div class="label">å‡ºå°„Stokes</div>
                            <div class="value" id="stokesOut11">[0.5,0.5,0,0]</div>
                        </div>
                    </div>
                </div>
            </section>
        </main>
    </div>

    <script>
        // Navigation
        document.querySelectorAll('.demo-list a').forEach(link => {
            link.addEventListener('click', (e) => {
                e.preventDefault();
                const demoId = link.dataset.demo;

                // Update active states
                document.querySelectorAll('.demo-list a').forEach(l => l.classList.remove('active'));
                link.classList.add('active');

                document.querySelectorAll('.demo-section').forEach(s => s.classList.remove('active'));
                document.getElementById(demoId).classList.add('active');
            });
        });

        // Utility functions
        function toRad(deg) { return deg * Math.PI / 180; }
        function toDeg(rad) { return rad * 180 / Math.PI; }

        // ============ DEMO 1: Malus's Law ============
        const canvas1 = document.getElementById('canvas1');
        const ctx1 = canvas1.getContext('2d');
        const angle1Slider = document.getElementById('angle1');
        let angle1 = 0;
        let time1 = 0;

        function updateDemo1() {
            angle1 = parseInt(angle1Slider.value);
            document.getElementById('angle1Val').textContent = angle1 + 'Â°';

            const rad = toRad(angle1);
            const intensity = Math.pow(Math.cos(rad), 2);
            document.getElementById('intensity1').textContent = Math.round(intensity * 100) + '%';
            document.getElementById('cos2val1').textContent = intensity.toFixed(2);
        }

        function drawDemo1() {
            ctx1.clearRect(0, 0, canvas1.width, canvas1.height);
            const width = canvas1.width;
            const height = canvas1.height;
            const centerY = height / 2;

            const rad = toRad(angle1);
            const amplitudeFactor = Math.abs(Math.cos(rad));

            // Axis
            ctx1.strokeStyle = '#333';
            ctx1.lineWidth = 1;
            ctx1.beginPath();
            ctx1.moveTo(0, centerY);
            ctx1.lineTo(width, centerY);
            ctx1.stroke();

            // Polarizer 1 (fixed)
            const p1X = width * 0.2;
            ctx1.save();
            ctx1.translate(p1X, centerY);
            ctx1.strokeStyle = '#00ccff';
            ctx1.lineWidth = 4;
            ctx1.beginPath();
            ctx1.arc(0, 0, 40, 0, Math.PI * 2);
            ctx1.stroke();
            ctx1.lineWidth = 2;
            ctx1.beginPath();
            ctx1.moveTo(0, -35);
            ctx1.lineTo(0, 35);
            ctx1.stroke();
            ctx1.fillStyle = '#00ccff';
            ctx1.font = '14px Arial';
            ctx1.textAlign = 'center';
            ctx1.fillText('èµ·åå™¨ (å›ºå®š)', 0, -55);
            ctx1.restore();

            // Polarizer 2 (rotating)
            const p2X = width * 0.8;
            ctx1.save();
            ctx1.translate(p2X, centerY);
            ctx1.rotate(rad);
            ctx1.strokeStyle = '#ffcc00';
            ctx1.lineWidth = 4;
            ctx1.beginPath();
            ctx1.arc(0, 0, 40, 0, Math.PI * 2);
            ctx1.stroke();
            ctx1.lineWidth = 2;
            ctx1.beginPath();
            ctx1.moveTo(0, -35);
            ctx1.lineTo(0, 35);
            ctx1.stroke();
            ctx1.restore();

            ctx1.fillStyle = '#ffcc00';
            ctx1.font = '14px Arial';
            ctx1.textAlign = 'center';
            ctx1.fillText('æ£€åå™¨', p2X, centerY - 55);

            // Waves
            // Before P1
            ctx1.strokeStyle = 'rgba(255, 255, 255, 0.3)';
            ctx1.lineWidth = 1;
            ctx1.beginPath();
            for (let x = 0; x < p1X - 40; x++) {
                const y = centerY + Math.sin((x - time1) * 0.1) * 20 + Math.cos((x + time1) * 0.15) * 15;
                if (x === 0) ctx1.moveTo(x, y);
                else ctx1.lineTo(x, y);
            }
            ctx1.stroke();

            // Between P1 and P2
            ctx1.strokeStyle = '#00ccff';
            ctx1.lineWidth = 2;
            ctx1.beginPath();
            for (let x = p1X + 40; x < p2X - 40; x++) {
                const y = centerY + Math.sin((x - time1) * 0.1) * 30;
                if (x === p1X + 40) ctx1.moveTo(x, y);
                else ctx1.lineTo(x, y);
            }
            ctx1.stroke();

            // After P2
            ctx1.strokeStyle = `rgba(255, 204, 0, ${0.2 + amplitudeFactor * 0.8})`;
            ctx1.lineWidth = 2;
            ctx1.beginPath();
            for (let x = p2X + 40; x < width; x++) {
                const y = centerY + Math.sin((x - time1) * 0.1) * 30 * amplitudeFactor;
                if (x === p2X + 40) ctx1.moveTo(x, y);
                else ctx1.lineTo(x, y);
            }
            ctx1.stroke();

            time1 += 2;
            requestAnimationFrame(drawDemo1);
        }

        angle1Slider.addEventListener('input', updateDemo1);
        updateDemo1();
        drawDemo1();

        // ============ DEMO 2: Game Prototype ============
        const angle2Slider = document.getElementById('angle2');
        const filter2 = document.getElementById('filter2-2');
        const beam3 = document.getElementById('beam2-3');
        const sensor2 = document.getElementById('sensor2');

        function updateDemo2() {
            const theta = parseInt(angle2Slider.value);
            document.getElementById('angle2Val').textContent = theta + 'Â°';

            filter2.style.transform = `rotate(${theta}deg)`;

            const rad = toRad(theta);
            const intensity = Math.pow(Math.cos(rad), 2);
            const percent = Math.round(intensity * 100);

            document.getElementById('intensity2').textContent = percent;
            beam3.style.opacity = intensity;

            if (percent > 80) {
                sensor2.classList.add('active');
                sensor2.textContent = 'ğŸ”“';
                sensor2.style.background = '#0f0';
                sensor2.style.boxShadow = '0 0 30px #0f0';
                document.getElementById('status2').textContent = 'èƒ½é‡å……è¶³ï¼é—¨å·²å¼€å¯';
                document.getElementById('status2').style.color = '#0f0';
            } else {
                sensor2.classList.remove('active');
                sensor2.textContent = 'ğŸ”’';
                sensor2.style.background = '#333';
                sensor2.style.boxShadow = 'none';
                if (percent < 10) {
                    document.getElementById('status2').textContent = 'å…‰è·¯è¢«é˜»æ–­ (æ¶ˆå…‰çŠ¶æ€)';
                    document.getElementById('status2').style.color = '#555';
                } else {
                    document.getElementById('status2').textContent = 'èƒ½é‡ä¸è¶³...';
                    document.getElementById('status2').style.color = '#ff5555';
                }
            }
        }

        angle2Slider.addEventListener('input', updateDemo2);
        updateDemo2();

        // ============ DEMO 3: Polarization States ============
        const canvas3_3d = document.getElementById('canvas3-3d');
        const ctx3_3d = canvas3_3d.getContext('2d');
        const canvas3_2d = document.getElementById('canvas3-2d');
        const ctx3_2d = canvas3_2d.getContext('2d');

        let phase3 = 0, ampX3 = 1, ampY3 = 1, time3 = 0;

        function setDemo3Preset(p, ax, ay) {
            document.getElementById('phase3').value = p;
            document.getElementById('ampX3').value = ax * 100;
            document.getElementById('ampY3').value = ay * 100;
            updateDemo3Values();
        }

        function updateDemo3Values() {
            phase3 = parseInt(document.getElementById('phase3').value);
            ampX3 = parseInt(document.getElementById('ampX3').value) / 100;
            ampY3 = parseInt(document.getElementById('ampY3').value) / 100;

            document.getElementById('phase3Val').textContent = phase3 + 'Â°';
            document.getElementById('ampX3Val').textContent = ampX3.toFixed(1);
            document.getElementById('ampY3Val').textContent = ampY3.toFixed(1);

            let state = 'æ¤­åœ†åæŒ¯';
            if (Math.abs(ampX3 - ampY3) < 0.1 && (Math.abs(phase3 - 90) < 5 || Math.abs(phase3 - 270) < 5)) {
                state = 'åœ†åæŒ¯';
            } else if (phase3 < 5 || Math.abs(phase3 - 180) < 5 || phase3 > 355) {
                state = 'çº¿åæŒ¯';
            } else if (ampX3 < 0.05 || ampY3 < 0.05) {
                state = 'çº¿åæŒ¯';
            }
            document.getElementById('state3').textContent = state;
        }

        function drawDemo3() {
            // 3D View
            ctx3_3d.clearRect(0, 0, canvas3_3d.width, canvas3_3d.height);
            const w = canvas3_3d.width, h = canvas3_3d.height;
            const axisY = h / 2;

            ctx3_3d.strokeStyle = '#333';
            ctx3_3d.beginPath();
            ctx3_3d.moveTo(0, axisY);
            ctx3_3d.lineTo(w, axisY);
            ctx3_3d.stroke();

            const k = 0.05, speed = 0.1, scale = 35;
            const slantX = 0.5, slantY = -0.3;
            const phaseRad = toRad(phase3);

            // Ex component
            ctx3_3d.strokeStyle = 'rgba(255, 68, 68, 0.5)';
            ctx3_3d.lineWidth = 2;
            ctx3_3d.beginPath();
            for (let i = 0; i < w; i += 2) {
                const val = ampX3 * Math.cos(k * i - time3 * speed);
                const sx = i + val * scale * slantX;
                const sy = axisY + val * scale * slantY;
                if (i === 0) ctx3_3d.moveTo(sx, sy);
                else ctx3_3d.lineTo(sx, sy);
            }
            ctx3_3d.stroke();

            // Ey component
            ctx3_3d.strokeStyle = 'rgba(68, 255, 68, 0.5)';
            ctx3_3d.beginPath();
            for (let i = 0; i < w; i += 2) {
                const val = ampY3 * Math.cos(k * i - time3 * speed + phaseRad);
                const sy = axisY - val * scale;
                if (i === 0) ctx3_3d.moveTo(i, sy);
                else ctx3_3d.lineTo(i, sy);
            }
            ctx3_3d.stroke();

            // Resultant
            ctx3_3d.strokeStyle = '#ffff00';
            ctx3_3d.lineWidth = 3;
            ctx3_3d.beginPath();
            for (let i = 0; i < w; i++) {
                const valX = ampX3 * Math.cos(k * i - time3 * speed);
                const valY = ampY3 * Math.cos(k * i - time3 * speed + phaseRad);
                const sx = i + valX * scale * slantX;
                const sy = axisY + (valX * scale * slantY) - (valY * scale);
                if (i === 0) ctx3_3d.moveTo(sx, sy);
                else ctx3_3d.lineTo(sx, sy);
            }
            ctx3_3d.stroke();

            // 2D Cross Section
            ctx3_2d.clearRect(0, 0, canvas3_2d.width, canvas3_2d.height);
            const cx = canvas3_2d.width / 2, cy = canvas3_2d.height / 2;
            const radius = 70;

            ctx3_2d.strokeStyle = '#444';
            ctx3_2d.beginPath();
            ctx3_2d.moveTo(cx, 0);
            ctx3_2d.lineTo(cx, canvas3_2d.height);
            ctx3_2d.stroke();
            ctx3_2d.beginPath();
            ctx3_2d.moveTo(0, cy);
            ctx3_2d.lineTo(canvas3_2d.width, cy);
            ctx3_2d.stroke();

            // Trace
            ctx3_2d.strokeStyle = 'rgba(255, 255, 0, 0.4)';
            ctx3_2d.lineWidth = 2;
            ctx3_2d.beginPath();
            for (let a = 0; a <= Math.PI * 2; a += 0.05) {
                const px = ampX3 * Math.cos(a) * radius;
                const py = ampY3 * Math.cos(a + phaseRad) * radius;
                if (a === 0) ctx3_2d.moveTo(cx + px, cy - py);
                else ctx3_2d.lineTo(cx + px, cy - py);
            }
            ctx3_2d.closePath();
            ctx3_2d.stroke();

            // Current vector
            const vecX = ampX3 * Math.cos(-time3 * speed) * radius;
            const vecY = ampY3 * Math.cos(-time3 * speed + phaseRad) * radius;

            ctx3_2d.strokeStyle = '#ffff00';
            ctx3_2d.lineWidth = 3;
            ctx3_2d.beginPath();
            ctx3_2d.moveTo(cx, cy);
            ctx3_2d.lineTo(cx + vecX, cy - vecY);
            ctx3_2d.stroke();

            ctx3_2d.fillStyle = '#ffff00';
            ctx3_2d.beginPath();
            ctx3_2d.arc(cx + vecX, cy - vecY, 5, 0, Math.PI * 2);
            ctx3_2d.fill();

            time3++;
            requestAnimationFrame(drawDemo3);
        }

        document.getElementById('phase3').addEventListener('input', updateDemo3Values);
        document.getElementById('ampX3').addEventListener('input', updateDemo3Values);
        document.getElementById('ampY3').addEventListener('input', updateDemo3Values);
        updateDemo3Values();
        drawDemo3();

        // ============ DEMO 4: Birefringence ============
        const canvas4 = document.getElementById('canvas4');
        const ctx4 = canvas4.getContext('2d');
        let time4 = 0;

        function updateDemo4() {
            const inAngle = parseInt(document.getElementById('inAngle4').value);
            const axisAngle = parseInt(document.getElementById('axisAngle4').value);
            document.getElementById('inAngle4Val').textContent = inAngle + 'Â°';
            document.getElementById('axisAngle4Val').textContent = axisAngle + 'Â°';

            const rad = toRad(inAngle - axisAngle);
            const oInt = Math.pow(Math.sin(rad), 2);
            const eInt = Math.pow(Math.cos(rad), 2);

            document.getElementById('oIntensity4').textContent = Math.round(oInt * 100) + '%';
            document.getElementById('eIntensity4').textContent = Math.round(eInt * 100) + '%';
        }

        function drawDemo4() {
            ctx4.clearRect(0, 0, canvas4.width, canvas4.height);
            const w = canvas4.width, h = canvas4.height;
            const cy = h / 2;

            const inAngle = parseInt(document.getElementById('inAngle4').value);
            const axisAngle = parseInt(document.getElementById('axisAngle4').value);
            const rad = toRad(inAngle - axisAngle);
            const oAmp = Math.abs(Math.sin(rad));
            const eAmp = Math.abs(Math.cos(rad));

            // Crystal
            const crystalX = w * 0.35;
            const crystalW = w * 0.3;
            ctx4.fillStyle = 'rgba(100, 200, 255, 0.15)';
            ctx4.strokeStyle = 'rgba(100, 200, 255, 0.5)';
            ctx4.lineWidth = 2;
            ctx4.beginPath();
            ctx4.moveTo(crystalX, cy - 80);
            ctx4.lineTo(crystalX + crystalW, cy - 80);
            ctx4.lineTo(crystalX + crystalW + 30, cy);
            ctx4.lineTo(crystalX + crystalW, cy + 80);
            ctx4.lineTo(crystalX, cy + 80);
            ctx4.lineTo(crystalX - 30, cy);
            ctx4.closePath();
            ctx4.fill();
            ctx4.stroke();

            ctx4.fillStyle = '#64c8ff';
            ctx4.font = '14px Arial';
            ctx4.textAlign = 'center';
            ctx4.fillText('æ–¹è§£çŸ³æ™¶ä½“', crystalX + crystalW/2, cy - 100);

            // Optical axis indicator
            ctx4.save();
            ctx4.translate(crystalX + crystalW/2, cy);
            ctx4.rotate(toRad(axisAngle));
            ctx4.strokeStyle = 'rgba(255, 255, 255, 0.3)';
            ctx4.setLineDash([5, 5]);
            ctx4.beginPath();
            ctx4.moveTo(-60, 0);
            ctx4.lineTo(60, 0);
            ctx4.stroke();
            ctx4.setLineDash([]);
            ctx4.fillStyle = '#888';
            ctx4.font = '12px Arial';
            ctx4.fillText('å…‰è½´', 70, 5);
            ctx4.restore();

            // Input beam
            ctx4.strokeStyle = '#ffcc00';
            ctx4.lineWidth = 2;
            ctx4.beginPath();
            for (let x = 20; x < crystalX - 30; x++) {
                const y = cy + Math.sin((x - time4) * 0.15) * 20;
                if (x === 20) ctx4.moveTo(x, y);
                else ctx4.lineTo(x, y);
            }
            ctx4.stroke();

            ctx4.fillStyle = '#ffcc00';
            ctx4.font = '12px Arial';
            ctx4.textAlign = 'left';
            ctx4.fillText(`å…¥å°„å…‰ (${inAngle}Â°)`, 20, cy - 40);

            // O-ray (ordinary)
            const oEndX = w - 40;
            const oEndY = cy + 40;
            ctx4.strokeStyle = `rgba(0, 255, 136, ${0.3 + oAmp * 0.7})`;
            ctx4.lineWidth = 2 + oAmp * 2;
            ctx4.beginPath();
            for (let t = 0; t <= 1; t += 0.02) {
                const x = (crystalX + crystalW + 30) + (oEndX - crystalX - crystalW - 30) * t;
                const y = cy + (oEndY - cy) * t + Math.sin((x - time4) * 0.15) * 15 * oAmp;
                if (t === 0) ctx4.moveTo(x, y);
                else ctx4.lineTo(x, y);
            }
            ctx4.stroke();

            ctx4.fillStyle = '#00ff88';
            ctx4.fillText(`oå…‰ (${Math.round(oAmp*100)}%)`, oEndX - 80, oEndY + 30);

            // E-ray (extraordinary)
            const eEndY = cy - 40;
            ctx4.strokeStyle = `rgba(255, 136, 0, ${0.3 + eAmp * 0.7})`;
            ctx4.lineWidth = 2 + eAmp * 2;
            ctx4.beginPath();
            for (let t = 0; t <= 1; t += 0.02) {
                const x = (crystalX + crystalW + 30) + (oEndX - crystalX - crystalW - 30) * t;
                const y = cy + (eEndY - cy) * t + Math.sin((x - time4) * 0.15) * 15 * eAmp;
                if (t === 0) ctx4.moveTo(x, y);
                else ctx4.lineTo(x, y);
            }
            ctx4.stroke();

            ctx4.fillStyle = '#ff8800';
            ctx4.fillText(`eå…‰ (${Math.round(eAmp*100)}%)`, oEndX - 80, eEndY - 20);

            time4 += 2;
            requestAnimationFrame(drawDemo4);
        }

        document.getElementById('inAngle4').addEventListener('input', updateDemo4);
        document.getElementById('axisAngle4').addEventListener('input', updateDemo4);
        updateDemo4();
        drawDemo4();

        // ============ DEMO 5: Wave Plates ============
        const canvas5In = document.getElementById('canvas5-in');
        const ctx5In = canvas5In.getContext('2d');
        const canvas5Out = document.getElementById('canvas5-out');
        const ctx5Out = canvas5Out.getContext('2d');
        let time5 = 0;

        function setDemo5Preset(type) {
            if (type === 'quarter') document.getElementById('retard5').value = 90;
            else if (type === 'half') document.getElementById('retard5').value = 180;
            else if (type === 'full') document.getElementById('retard5').value = 360;
            updateDemo5();
        }

        function updateDemo5() {
            const retard = parseInt(document.getElementById('retard5').value);
            const inPol = parseInt(document.getElementById('inPol5').value);
            const fastAxis = parseInt(document.getElementById('fastAxis5').value);

            let retardLabel = retard + 'Â°';
            if (Math.abs(retard - 90) < 5) retardLabel = '90Â° (Î»/4)';
            else if (Math.abs(retard - 180) < 5) retardLabel = '180Â° (Î»/2)';
            else if (Math.abs(retard - 360) < 5 || retard < 5) retardLabel = '360Â° (Î»)';

            document.getElementById('retard5Val').textContent = retardLabel;
            document.getElementById('inPol5Val').textContent = inPol + 'Â°';
            document.getElementById('fastAxis5Val').textContent = fastAxis + 'Â°';
            document.getElementById('waveplate5').textContent =
                Math.abs(retard - 90) < 5 ? 'Î»/4' :
                Math.abs(retard - 180) < 5 ? 'Î»/2' :
                Math.abs(retard - 360) < 5 ? 'Î»' : `${retard}Â°`;

            document.getElementById('inState5').textContent = 'çº¿åæŒ¯ ' + inPol + 'Â°';

            const theta = toRad(inPol - fastAxis);
            const delta = toRad(retard);

            if (Math.abs(retard - 90) < 5 && Math.abs(Math.abs(theta) - Math.PI/4) < 0.1) {
                document.getElementById('outState5').textContent = 'åœ†åæŒ¯';
            } else if (Math.abs(retard - 180) < 5) {
                const newAngle = 2 * fastAxis - inPol;
                document.getElementById('outState5').textContent = 'çº¿åæŒ¯ ' + ((newAngle + 180) % 180) + 'Â°';
            } else if (retard < 5 || Math.abs(retard - 360) < 5) {
                document.getElementById('outState5').textContent = 'çº¿åæŒ¯ ' + inPol + 'Â° (ä¸å˜)';
            } else {
                document.getElementById('outState5').textContent = 'æ¤­åœ†åæŒ¯';
            }
        }

        function drawDemo5() {
            const retard = parseInt(document.getElementById('retard5').value);
            const inPol = parseInt(document.getElementById('inPol5').value);
            const fastAxis = parseInt(document.getElementById('fastAxis5').value);

            // Input (always linear)
            ctx5In.clearRect(0, 0, 200, 200);
            const cx = 100, cy = 100, r = 60;

            ctx5In.strokeStyle = '#444';
            ctx5In.beginPath();
            ctx5In.moveTo(cx, 0); ctx5In.lineTo(cx, 200);
            ctx5In.moveTo(0, cy); ctx5In.lineTo(200, cy);
            ctx5In.stroke();

            const inRad = toRad(inPol);
            ctx5In.strokeStyle = '#ffff00';
            ctx5In.lineWidth = 3;
            ctx5In.beginPath();
            ctx5In.moveTo(cx - Math.cos(inRad) * r, cy - Math.sin(inRad) * r);
            ctx5In.lineTo(cx + Math.cos(inRad) * r, cy + Math.sin(inRad) * r);
            ctx5In.stroke();

            // Output
            ctx5Out.clearRect(0, 0, 200, 200);
            ctx5Out.strokeStyle = '#444';
            ctx5Out.beginPath();
            ctx5Out.moveTo(cx, 0); ctx5Out.lineTo(cx, 200);
            ctx5Out.moveTo(0, cy); ctx5Out.lineTo(200, cy);
            ctx5Out.stroke();

            const theta = inPol - fastAxis;
            const thetaRad = toRad(theta);
            const delta = toRad(retard);

            // Calculate output amplitudes
            const aFast = Math.cos(thetaRad);
            const aSlow = Math.sin(thetaRad);

            ctx5Out.strokeStyle = 'rgba(255, 255, 0, 0.4)';
            ctx5Out.lineWidth = 2;
            ctx5Out.beginPath();

            for (let t = 0; t <= Math.PI * 2; t += 0.05) {
                const eFast = aFast * Math.cos(t);
                const eSlow = aSlow * Math.cos(t + delta);

                const ex = eFast * Math.cos(toRad(fastAxis)) - eSlow * Math.sin(toRad(fastAxis));
                const ey = eFast * Math.sin(toRad(fastAxis)) + eSlow * Math.cos(toRad(fastAxis));

                if (t === 0) ctx5Out.moveTo(cx + ex * r, cy - ey * r);
                else ctx5Out.lineTo(cx + ex * r, cy - ey * r);
            }
            ctx5Out.closePath();
            ctx5Out.stroke();

            // Animated vector
            const tNow = time5 * 0.1;
            const eFastNow = aFast * Math.cos(tNow);
            const eSlowNow = aSlow * Math.cos(tNow + delta);
            const exNow = eFastNow * Math.cos(toRad(fastAxis)) - eSlowNow * Math.sin(toRad(fastAxis));
            const eyNow = eFastNow * Math.sin(toRad(fastAxis)) + eSlowNow * Math.cos(toRad(fastAxis));

            ctx5Out.strokeStyle = '#ffff00';
            ctx5Out.lineWidth = 3;
            ctx5Out.beginPath();
            ctx5Out.moveTo(cx, cy);
            ctx5Out.lineTo(cx + exNow * r, cy - eyNow * r);
            ctx5Out.stroke();

            ctx5Out.fillStyle = '#ffff00';
            ctx5Out.beginPath();
            ctx5Out.arc(cx + exNow * r, cy - eyNow * r, 5, 0, Math.PI * 2);
            ctx5Out.fill();

            time5++;
            requestAnimationFrame(drawDemo5);
        }

        document.getElementById('retard5').addEventListener('input', updateDemo5);
        document.getElementById('inPol5').addEventListener('input', updateDemo5);
        document.getElementById('fastAxis5').addEventListener('input', updateDemo5);
        updateDemo5();
        drawDemo5();

        // ============ DEMO 6: Brewster's Angle ============
        const canvas6 = document.getElementById('canvas6');
        const ctx6 = canvas6.getContext('2d');

        function updateDemo6() {
            const incAngle = parseInt(document.getElementById('incAngle6').value);
            const n2 = parseInt(document.getElementById('n2_6').value) / 100;

            document.getElementById('incAngle6Val').textContent = incAngle + 'Â°';
            document.getElementById('n2Val6').textContent = n2.toFixed(2);

            const brewsterAngle = toDeg(Math.atan(n2));
            document.getElementById('brewster6').textContent = brewsterAngle.toFixed(1) + 'Â°';

            // Fresnel equations
            const theta1 = toRad(incAngle);
            const sinTheta2 = Math.sin(theta1) / n2;
            const theta2 = Math.asin(Math.min(1, sinTheta2));

            // p-polarization reflectance
            const rp = Math.pow((n2 * Math.cos(theta1) - Math.cos(theta2)) /
                               (n2 * Math.cos(theta1) + Math.cos(theta2)), 2);
            // s-polarization reflectance
            const rs = Math.pow((Math.cos(theta1) - n2 * Math.cos(theta2)) /
                               (Math.cos(theta1) + n2 * Math.cos(theta2)), 2);

            document.getElementById('rp6').textContent = Math.round(rp * 100) + '%';
            document.getElementById('rs6').textContent = Math.round(rs * 100) + '%';
        }

        function drawDemo6() {
            ctx6.clearRect(0, 0, canvas6.width, canvas6.height);
            const w = canvas6.width, h = canvas6.height;
            const interfaceY = h * 0.5;

            const incAngle = parseInt(document.getElementById('incAngle6').value);
            const n2 = parseInt(document.getElementById('n2_6').value) / 100;

            // Media
            ctx6.fillStyle = 'rgba(100, 180, 255, 0.1)';
            ctx6.fillRect(0, interfaceY, w, h - interfaceY);

            ctx6.strokeStyle = '#64c8ff';
            ctx6.lineWidth = 2;
            ctx6.beginPath();
            ctx6.moveTo(0, interfaceY);
            ctx6.lineTo(w, interfaceY);
            ctx6.stroke();

            ctx6.fillStyle = '#888';
            ctx6.font = '14px Arial';
            ctx6.fillText('ç©ºæ°” (nâ‚ = 1.0)', 20, interfaceY - 20);
            ctx6.fillText(`ç»ç’ƒ (nâ‚‚ = ${n2.toFixed(2)})`, 20, interfaceY + 30);

            // Normal
            ctx6.strokeStyle = '#555';
            ctx6.setLineDash([5, 5]);
            ctx6.beginPath();
            ctx6.moveTo(w/2, interfaceY - 150);
            ctx6.lineTo(w/2, interfaceY + 150);
            ctx6.stroke();
            ctx6.setLineDash([]);

            const incRad = toRad(incAngle);
            const hitX = w/2, hitY = interfaceY;
            const rayLen = 150;

            // Incident ray
            const incStartX = hitX - rayLen * Math.sin(incRad);
            const incStartY = hitY - rayLen * Math.cos(incRad);

            ctx6.strokeStyle = '#ffcc00';
            ctx6.lineWidth = 4;
            ctx6.beginPath();
            ctx6.moveTo(incStartX, incStartY);
            ctx6.lineTo(hitX, hitY);
            ctx6.stroke();

            // Arrow
            ctx6.fillStyle = '#ffcc00';
            ctx6.beginPath();
            ctx6.moveTo(hitX, hitY);
            ctx6.lineTo(hitX - 10 * Math.sin(incRad - 0.3), hitY - 10 * Math.cos(incRad - 0.3));
            ctx6.lineTo(hitX - 10 * Math.sin(incRad + 0.3), hitY - 10 * Math.cos(incRad + 0.3));
            ctx6.fill();

            // Reflected ray
            const sinTheta2 = Math.sin(incRad) / n2;
            const theta2 = Math.asin(Math.min(1, sinTheta2));

            const rp = Math.pow((n2 * Math.cos(incRad) - Math.cos(theta2)) /
                               (n2 * Math.cos(incRad) + Math.cos(theta2)), 2);
            const rs = Math.pow((Math.cos(incRad) - n2 * Math.cos(theta2)) /
                               (Math.cos(incRad) + n2 * Math.cos(theta2)), 2);

            const refEndX = hitX + rayLen * Math.sin(incRad);
            const refEndY = hitY - rayLen * Math.cos(incRad);

            // s-polarization (reflected)
            ctx6.strokeStyle = `rgba(102, 102, 255, ${0.3 + rs * 0.7})`;
            ctx6.lineWidth = 2 + rs * 4;
            ctx6.beginPath();
            ctx6.moveTo(hitX, hitY);
            ctx6.lineTo(refEndX, refEndY);
            ctx6.stroke();

            // p-polarization (reflected)
            ctx6.strokeStyle = `rgba(255, 102, 102, ${0.3 + rp * 0.7})`;
            ctx6.lineWidth = 2 + rp * 4;
            ctx6.beginPath();
            ctx6.moveTo(hitX, hitY);
            ctx6.lineTo(refEndX - 10, refEndY + 10);
            ctx6.stroke();

            // Refracted ray
            const transEndX = hitX + rayLen * Math.sin(theta2);
            const transEndY = hitY + rayLen * Math.cos(theta2);

            ctx6.strokeStyle = 'rgba(100, 255, 100, 0.7)';
            ctx6.lineWidth = 4;
            ctx6.beginPath();
            ctx6.moveTo(hitX, hitY);
            ctx6.lineTo(transEndX, transEndY);
            ctx6.stroke();

            // Labels
            ctx6.fillStyle = '#ffcc00';
            ctx6.font = '12px Arial';
            ctx6.fillText('å…¥å°„å…‰', incStartX - 40, incStartY + 20);

            ctx6.fillStyle = '#6666ff';
            ctx6.fillText('såå°„', refEndX + 10, refEndY + 20);

            ctx6.fillStyle = '#ff6666';
            ctx6.fillText('påå°„', refEndX - 60, refEndY);

            ctx6.fillStyle = '#66ff66';
            ctx6.fillText('æŠ˜å°„å…‰', transEndX + 10, transEndY - 10);

            // Brewster indicator
            const brewsterAngle = toDeg(Math.atan(n2));
            if (Math.abs(incAngle - brewsterAngle) < 2) {
                ctx6.fillStyle = '#ff0';
                ctx6.font = 'bold 16px Arial';
                ctx6.fillText('âœ“ å¸ƒå„’æ–¯ç‰¹è§’ï¼påæŒ¯æ— åå°„', w/2 - 100, 30);
            }

            requestAnimationFrame(drawDemo6);
        }

        document.getElementById('incAngle6').addEventListener('input', updateDemo6);
        document.getElementById('n2_6').addEventListener('input', updateDemo6);
        updateDemo6();
        drawDemo6();

        // ============ DEMO 7: Interference ============
        const canvas7 = document.getElementById('canvas7');
        const ctx7 = canvas7.getContext('2d');
        let time7 = 0;

        function updateDemo7() {
            const pol7a = parseInt(document.getElementById('pol7a').value);
            const pol7b = parseInt(document.getElementById('pol7b').value);
            const phase7 = parseInt(document.getElementById('phase7').value);
            const ampRatio = parseInt(document.getElementById('ampRatio7').value) / 100;

            document.getElementById('pol7aVal').textContent = pol7a + 'Â°';
            document.getElementById('pol7bVal').textContent = pol7b + 'Â°';
            document.getElementById('phase7Val').textContent = phase7 + 'Â°';
            document.getElementById('ampRatio7Val').textContent = ampRatio.toFixed(1);

            // Calculate interference
            const polDiff = Math.abs(pol7a - pol7b);
            const parallelFactor = Math.pow(Math.cos(toRad(polDiff)), 2);
            const phaseFactor = Math.cos(toRad(phase7));

            // I = I1 + I2 + 2*sqrt(I1*I2)*cos(phi)*cos^2(theta/2)
            const i1 = 1, i2 = ampRatio * ampRatio;
            const interference = 2 * Math.sqrt(i1 * i2) * phaseFactor * parallelFactor;
            const totalI = i1 + i2 + interference;

            document.getElementById('resultI7').textContent = Math.round(totalI * 100) + '%';

            if (polDiff > 85) {
                document.getElementById('intType7').textContent = 'æ— å¹²æ¶‰ (æ­£äº¤)';
            } else if (Math.abs(phase7) < 10 || Math.abs(phase7 - 360) < 10) {
                document.getElementById('intType7').textContent = 'ç›¸é•¿å¹²æ¶‰';
            } else if (Math.abs(phase7 - 180) < 10) {
                document.getElementById('intType7').textContent = ampRatio > 0.9 ? 'ç›¸æ¶ˆå¹²æ¶‰' : 'éƒ¨åˆ†ç›¸æ¶ˆ';
            } else {
                document.getElementById('intType7').textContent = 'éƒ¨åˆ†å¹²æ¶‰';
            }
        }

        function drawDemo7() {
            ctx7.clearRect(0, 0, canvas7.width, canvas7.height);
            const w = canvas7.width, h = canvas7.height;

            const pol7a = parseInt(document.getElementById('pol7a').value);
            const pol7b = parseInt(document.getElementById('pol7b').value);
            const phase7 = parseInt(document.getElementById('phase7').value);
            const ampRatio = parseInt(document.getElementById('ampRatio7').value) / 100;

            const cy1 = h * 0.25;
            const cy2 = h * 0.5;
            const cy3 = h * 0.75;

            // Wave 1
            ctx7.strokeStyle = '#ff6666';
            ctx7.lineWidth = 2;
            ctx7.beginPath();
            for (let x = 50; x < w - 50; x++) {
                const y = cy1 + Math.sin((x - time7) * 0.05) * 30;
                if (x === 50) ctx7.moveTo(x, y);
                else ctx7.lineTo(x, y);
            }
            ctx7.stroke();
            ctx7.fillStyle = '#ff6666';
            ctx7.font = '12px Arial';
            ctx7.fillText(`å…‰æŸ1 (${pol7a}Â°)`, 10, cy1 + 5);

            // Wave 2
            ctx7.strokeStyle = '#6666ff';
            ctx7.beginPath();
            for (let x = 50; x < w - 50; x++) {
                const y = cy2 + Math.sin((x - time7) * 0.05 + toRad(phase7)) * 30 * ampRatio;
                if (x === 50) ctx7.moveTo(x, y);
                else ctx7.lineTo(x, y);
            }
            ctx7.stroke();
            ctx7.fillStyle = '#6666ff';
            ctx7.fillText(`å…‰æŸ2 (${pol7b}Â°, Ï†=${phase7}Â°)`, 10, cy2 + 5);

            // Resultant
            const polDiff = Math.abs(pol7a - pol7b);
            const parallelFactor = Math.cos(toRad(polDiff));

            ctx7.strokeStyle = '#ffff00';
            ctx7.lineWidth = 3;
            ctx7.beginPath();
            for (let x = 50; x < w - 50; x++) {
                const wave1 = Math.sin((x - time7) * 0.05);
                const wave2 = Math.sin((x - time7) * 0.05 + toRad(phase7)) * ampRatio * parallelFactor;
                const y = cy3 + (wave1 + wave2) * 30;
                if (x === 50) ctx7.moveTo(x, y);
                else ctx7.lineTo(x, y);
            }
            ctx7.stroke();
            ctx7.fillStyle = '#ffff00';
            ctx7.fillText('åˆæˆæ³¢', 10, cy3 + 5);

            // Labels
            ctx7.strokeStyle = '#444';
            ctx7.setLineDash([2, 2]);
            ctx7.beginPath();
            ctx7.moveTo(50, 0);
            ctx7.lineTo(50, h);
            ctx7.stroke();
            ctx7.setLineDash([]);

            time7 += 2;
            requestAnimationFrame(drawDemo7);
        }

        document.getElementById('pol7a').addEventListener('input', updateDemo7);
        document.getElementById('pol7b').addEventListener('input', updateDemo7);
        document.getElementById('phase7').addEventListener('input', updateDemo7);
        document.getElementById('ampRatio7').addEventListener('input', updateDemo7);
        updateDemo7();
        drawDemo7();

        // ============ DEMO 8: Optical Activity ============
        const canvas8 = document.getElementById('canvas8');
        const ctx8 = canvas8.getContext('2d');
        let time8 = 0;

        function setDemo8Preset(type) {
            if (type === 'sugar') {
                document.getElementById('alpha8').value = 66;
                document.getElementById('conc8').value = 50;
            } else if (type === 'quartz') {
                document.getElementById('alpha8').value = 22;
                document.getElementById('conc8').value = 100;
            } else if (type === 'fructose') {
                document.getElementById('alpha8').value = -92;
                document.getElementById('conc8').value = 50;
            }
            updateDemo8();
        }

        function updateDemo8() {
            const conc = parseInt(document.getElementById('conc8').value) / 100;
            const path = parseInt(document.getElementById('path8').value) / 10;
            const alpha = parseInt(document.getElementById('alpha8').value);

            document.getElementById('conc8Val').textContent = conc.toFixed(2);
            document.getElementById('path8Val').textContent = path.toFixed(1);
            document.getElementById('alpha8Val').textContent = (alpha >= 0 ? '+' : '') + alpha;

            const rotation = alpha * conc * path;
            document.getElementById('rotation8').textContent = (rotation >= 0 ? '+' : '') + rotation.toFixed(1) + 'Â°';
            document.getElementById('direction8').textContent = rotation >= 0 ? 'å³æ—‹ (é¡ºæ—¶é’ˆ)' : 'å·¦æ—‹ (é€†æ—¶é’ˆ)';
        }

        function drawDemo8() {
            ctx8.clearRect(0, 0, canvas8.width, canvas8.height);
            const w = canvas8.width, h = canvas8.height;
            const cy = h / 2;

            const conc = parseInt(document.getElementById('conc8').value) / 100;
            const path = parseInt(document.getElementById('path8').value) / 10;
            const alpha = parseInt(document.getElementById('alpha8').value);
            const rotation = toRad(alpha * conc * path);

            // Container (sample tube)
            const tubeStart = w * 0.25;
            const tubeEnd = w * 0.75;
            const tubeH = 80;

            ctx8.fillStyle = 'rgba(255, 200, 100, 0.2)';
            ctx8.strokeStyle = 'rgba(255, 200, 100, 0.5)';
            ctx8.lineWidth = 2;
            ctx8.beginPath();
            ctx8.rect(tubeStart, cy - tubeH/2, tubeEnd - tubeStart, tubeH);
            ctx8.fill();
            ctx8.stroke();

            ctx8.fillStyle = '#ffcc66';
            ctx8.font = '14px Arial';
            ctx8.textAlign = 'center';
            ctx8.fillText('æ—‹å…‰æ€§æº¶æ¶²', (tubeStart + tubeEnd) / 2, cy - tubeH/2 - 15);

            // Input polarization
            const pSize = 50;
            ctx8.save();
            ctx8.translate(tubeStart - 60, cy);
            ctx8.strokeStyle = '#00ccff';
            ctx8.lineWidth = 3;
            ctx8.beginPath();
            ctx8.moveTo(0, -pSize);
            ctx8.lineTo(0, pSize);
            ctx8.stroke();
            ctx8.fillStyle = '#00ccff';
            ctx8.font = '12px Arial';
            ctx8.textAlign = 'center';
            ctx8.fillText('å…¥å°„ (0Â°)', 0, pSize + 20);
            ctx8.restore();

            // Light beam through sample
            ctx8.strokeStyle = '#ffff00';
            ctx8.lineWidth = 2;
            ctx8.beginPath();
            ctx8.moveTo(50, cy);
            ctx8.lineTo(tubeStart, cy);
            ctx8.stroke();

            // Rotating polarization inside tube
            for (let x = tubeStart; x < tubeEnd; x += 20) {
                const progress = (x - tubeStart) / (tubeEnd - tubeStart);
                const angle = rotation * progress;

                ctx8.save();
                ctx8.translate(x, cy);
                ctx8.rotate(angle);
                ctx8.strokeStyle = `rgba(255, 255, 0, ${0.3 + progress * 0.5})`;
                ctx8.lineWidth = 2;
                ctx8.beginPath();
                ctx8.moveTo(0, -15);
                ctx8.lineTo(0, 15);
                ctx8.stroke();
                ctx8.restore();
            }

            // Output beam
            ctx8.strokeStyle = '#ffff00';
            ctx8.lineWidth = 2;
            ctx8.beginPath();
            ctx8.moveTo(tubeEnd, cy);
            ctx8.lineTo(w - 50, cy);
            ctx8.stroke();

            // Output polarization
            ctx8.save();
            ctx8.translate(tubeEnd + 60, cy);
            ctx8.rotate(rotation);
            ctx8.strokeStyle = '#ffcc00';
            ctx8.lineWidth = 3;
            ctx8.beginPath();
            ctx8.moveTo(0, -pSize);
            ctx8.lineTo(0, pSize);
            ctx8.stroke();
            ctx8.restore();

            ctx8.fillStyle = '#ffcc00';
            ctx8.font = '12px Arial';
            ctx8.textAlign = 'center';
            ctx8.fillText(`å‡ºå°„ (${(alpha * conc * path).toFixed(1)}Â°)`, tubeEnd + 60, cy + pSize + 20);

            // Animated spiral (showing rotation)
            ctx8.strokeStyle = 'rgba(255, 255, 0, 0.3)';
            ctx8.lineWidth = 1;
            ctx8.beginPath();
            for (let t = 0; t <= 1; t += 0.01) {
                const x = tubeStart + (tubeEnd - tubeStart) * t;
                const angle = rotation * t + time8 * 0.05;
                const y = cy + Math.sin(angle) * 20;
                if (t === 0) ctx8.moveTo(x, y);
                else ctx8.lineTo(x, y);
            }
            ctx8.stroke();

            time8++;
            requestAnimationFrame(drawDemo8);
        }

        document.getElementById('conc8').addEventListener('input', updateDemo8);
        document.getElementById('path8').addEventListener('input', updateDemo8);
        document.getElementById('alpha8').addEventListener('input', updateDemo8);
        updateDemo8();
        drawDemo8();

        // ============ DEMO 9: Photoelasticity ============
        const canvas9 = document.getElementById('canvas9');
        const ctx9 = canvas9.getContext('2d');
        let stressPattern9 = 'point';

        function setDemo9Preset(type) {
            stressPattern9 = type;
        }

        function updateDemo9() {
            document.getElementById('stress9Val').textContent = document.getElementById('stress9').value + '%';
            document.getElementById('analyzerAngle9Val').textContent = document.getElementById('analyzerAngle9').value + 'Â°';
        }

        function drawDemo9() {
            ctx9.clearRect(0, 0, canvas9.width, canvas9.height);
            const w = canvas9.width, h = canvas9.height;
            const cx = w / 2, cy = h / 2;

            const stress = parseInt(document.getElementById('stress9').value) / 100;
            const analyzerAngle = parseInt(document.getElementById('analyzerAngle9').value);

            // Background (crossed polarizers = dark)
            ctx9.fillStyle = analyzerAngle === 90 ? '#111' : '#333';
            ctx9.fillRect(0, 0, w, h);

            // Sample area
            const size = 160;
            const imgData = ctx9.createImageData(w, h);

            for (let y = 0; y < h; y++) {
                for (let x = 0; x < w; x++) {
                    const dx = x - cx;
                    const dy = y - cy;

                    let stressDiff = 0;
                    let stressAngle = 0;

                    if (stressPattern9 === 'point') {
                        // Point load - radial stress pattern
                        const r = Math.sqrt(dx * dx + dy * dy);
                        if (r > 20 && r < size) {
                            stressDiff = stress * 200 / (r + 10);
                            stressAngle = Math.atan2(dy, dx);
                        }
                    } else if (stressPattern9 === 'tension') {
                        // Uniform tension
                        if (Math.abs(dx) < size && Math.abs(dy) < size * 0.6) {
                            stressDiff = stress * 100;
                            stressAngle = 0;
                        }
                    } else if (stressPattern9 === 'bend') {
                        // Bending - linear gradient
                        if (Math.abs(dx) < size && Math.abs(dy) < size * 0.4) {
                            stressDiff = stress * Math.abs(dy) * 2;
                            stressAngle = dy > 0 ? 0 : Math.PI;
                        }
                    } else if (stressPattern9 === 'hole') {
                        // Stress concentration around hole
                        const r = Math.sqrt(dx * dx + dy * dy);
                        const holeR = 30;
                        if (r > holeR && r < size) {
                            const factor = (holeR * holeR) / (r * r);
                            stressDiff = stress * 150 * (1 + factor + factor * Math.cos(2 * Math.atan2(dy, dx)));
                            stressAngle = Math.atan2(dy, dx);
                        }
                    }

                    if (stressDiff > 0) {
                        // Birefringence color calculation
                        const delta = stressDiff * Math.PI / 50;
                        const theta = stressAngle - toRad(analyzerAngle / 2);

                        // Intensity through crossed polarizers
                        const intensity = Math.pow(Math.sin(2 * theta), 2) * Math.pow(Math.sin(delta / 2), 2);

                        // Wavelength-dependent retardation for colors
                        const retardation = stressDiff;

                        let r, g, b;
                        // Michel-Levy color chart approximation
                        const order = retardation / 50;
                        const phase = (order % 1) * 2 * Math.PI;

                        r = Math.floor(128 + 127 * Math.sin(phase));
                        g = Math.floor(128 + 127 * Math.sin(phase + 2 * Math.PI / 3));
                        b = Math.floor(128 + 127 * Math.sin(phase + 4 * Math.PI / 3));

                        const brightness = intensity * 0.8 + 0.2;
                        r = Math.floor(r * brightness);
                        g = Math.floor(g * brightness);
                        b = Math.floor(b * brightness);

                        const idx = (y * w + x) * 4;
                        imgData.data[idx] = r;
                        imgData.data[idx + 1] = g;
                        imgData.data[idx + 2] = b;
                        imgData.data[idx + 3] = 255;
                    }
                }
            }

            ctx9.putImageData(imgData, 0, 0);

            // Draw hole for 'hole' pattern
            if (stressPattern9 === 'hole') {
                ctx9.fillStyle = '#111';
                ctx9.beginPath();
                ctx9.arc(cx, cy, 30, 0, Math.PI * 2);
                ctx9.fill();
            }

            // Labels
            ctx9.fillStyle = '#fff';
            ctx9.font = '14px Arial';
            ctx9.textAlign = 'left';
            ctx9.fillText('èµ·åå™¨ (0Â°)', 10, 25);
            ctx9.fillText(`æ£€åå™¨ (${analyzerAngle}Â°)`, 10, 45);

            // Pattern label
            const labels = {
                'point': 'ç‚¹è½½è·',
                'tension': 'æ‹‰ä¼¸åº”åŠ›',
                'bend': 'å¼¯æ›²åº”åŠ›',
                'hole': 'åœ†å­”åº”åŠ›é›†ä¸­'
            };
            ctx9.fillStyle = '#64c8ff';
            ctx9.font = '16px Arial';
            ctx9.textAlign = 'center';
            ctx9.fillText(labels[stressPattern9], cx, h - 20);

            requestAnimationFrame(drawDemo9);
        }

        document.getElementById('stress9').addEventListener('input', updateDemo9);
        document.getElementById('analyzerAngle9').addEventListener('input', updateDemo9);
        updateDemo9();
        drawDemo9();

        // ============ DEMO 10: Rayleigh & Mie Scattering ============
        const canvas10 = document.getElementById('canvas10');
        const ctx10 = canvas10.getContext('2d');
        let particleSize10 = 100;
        let observeAngle10 = 90;
        let time10 = 0;

        function setScatterPreset(preset) {
            const presets = {
                'sky': { size: 20, angle: 90 },
                'cloud': { size: 1000, angle: 45 },
                'sunset': { size: 50, angle: 10 },
                'milk': { size: 300, angle: 90 }
            };
            const p = presets[preset];
            document.getElementById('particleSize10').value = p.size;
            document.getElementById('observeAngle10').value = p.angle;
            updateDemo10();
        }

        function updateDemo10() {
            particleSize10 = parseInt(document.getElementById('particleSize10').value);
            observeAngle10 = parseInt(document.getElementById('observeAngle10').value);

            document.getElementById('particleSize10Val').textContent = particleSize10 + 'nm';
            document.getElementById('observeAngle10Val').textContent = observeAngle10 + 'Â°';

            // Determine scattering type
            const sizeParameter = particleSize10 / 500; // normalized to wavelength
            let scatterType = 'ç‘åˆ©æ•£å°„';
            if (sizeParameter > 0.5) scatterType = 'è¿‡æ¸¡åŒº';
            if (sizeParameter > 1) scatterType = 'ç±³æ°æ•£å°„';
            document.getElementById('scatterType10').textContent = scatterType;

            // Polarization degree (simplified model)
            const polarDeg = Math.sin(toRad(observeAngle10)) * (1 - sizeParameter * 0.3);
            document.getElementById('polarDegree10').textContent = Math.round(Math.max(0, Math.min(100, polarDeg * 100))) + '%';
        }

        function drawDemo10() {
            const w = canvas10.width;
            const h = canvas10.height;
            ctx10.clearRect(0, 0, w, h);

            // Background gradient simulating sky color based on particle size
            const sizeParam = particleSize10 / 500;
            let skyR = 50 + sizeParam * 150;
            let skyG = 100 + sizeParam * 100;
            let skyB = 255 - sizeParam * 50;

            // Adjust for observation angle (sunset effect)
            const sunsetFactor = Math.max(0, 1 - observeAngle10 / 90);
            skyR = Math.min(255, skyR + sunsetFactor * 200);
            skyG = Math.min(255, skyG * (1 - sunsetFactor * 0.5));
            skyB = Math.max(50, skyB * (1 - sunsetFactor));

            const grad = ctx10.createLinearGradient(0, 0, 0, h);
            grad.addColorStop(0, `rgb(${Math.round(skyR)}, ${Math.round(skyG)}, ${Math.round(skyB)})`);
            grad.addColorStop(1, `rgb(${Math.round(skyR * 0.3)}, ${Math.round(skyG * 0.3)}, ${Math.round(skyB * 0.4)})`);
            ctx10.fillStyle = grad;
            ctx10.fillRect(0, 0, w, h);

            // Draw sun
            const sunX = w * 0.8;
            const sunY = h * 0.2 + (90 - observeAngle10) * 2;
            const sunGrad = ctx10.createRadialGradient(sunX, sunY, 0, sunX, sunY, 60);
            sunGrad.addColorStop(0, 'rgba(255, 255, 200, 1)');
            sunGrad.addColorStop(0.3, 'rgba(255, 220, 100, 0.8)');
            sunGrad.addColorStop(1, 'rgba(255, 150, 50, 0)');
            ctx10.fillStyle = sunGrad;
            ctx10.beginPath();
            ctx10.arc(sunX, sunY, 60, 0, Math.PI * 2);
            ctx10.fill();

            // Draw particles
            const numParticles = Math.min(200, 50 + particleSize10 / 10);
            for (let i = 0; i < numParticles; i++) {
                const px = Math.random() * w;
                const py = Math.random() * h;
                const pSize = Math.max(1, particleSize10 / 300 + Math.random() * 2);

                // Color depends on size (Rayleigh = blue scatter, Mie = white)
                const blueShift = Math.max(0, 1 - sizeParam);
                const alpha = 0.3 + Math.random() * 0.4;
                ctx10.fillStyle = `rgba(${200 + blueShift * 55}, ${220 + blueShift * 35}, 255, ${alpha})`;
                ctx10.beginPath();
                ctx10.arc(px, py, pSize, 0, Math.PI * 2);
                ctx10.fill();
            }

            // Draw scattering diagram (polar plot)
            const diagramX = 150;
            const diagramY = h - 120;
            const diagramR = 80;

            // Background circle
            ctx10.fillStyle = 'rgba(0, 0, 0, 0.5)';
            ctx10.beginPath();
            ctx10.arc(diagramX, diagramY, diagramR + 10, 0, Math.PI * 2);
            ctx10.fill();

            ctx10.strokeStyle = '#444';
            ctx10.lineWidth = 1;
            ctx10.beginPath();
            ctx10.arc(diagramX, diagramY, diagramR, 0, Math.PI * 2);
            ctx10.stroke();

            // Draw scattering pattern
            ctx10.strokeStyle = '#00ff88';
            ctx10.lineWidth = 2;
            ctx10.beginPath();
            for (let angle = 0; angle <= 360; angle += 2) {
                const rad = toRad(angle);
                // Simplified scattering function
                let intensity;
                if (sizeParam < 0.3) {
                    // Rayleigh: (1 + cosÂ²Î¸) pattern
                    intensity = (1 + Math.pow(Math.cos(rad), 2)) / 2;
                } else {
                    // Mie: forward-peaked pattern
                    const forwardPeak = Math.exp(-Math.pow(angle - 0, 2) / (2000 * sizeParam));
                    intensity = 0.3 + forwardPeak * 0.7;
                }
                const r = diagramR * intensity;
                const x = diagramX + r * Math.cos(rad);
                const y = diagramY - r * Math.sin(rad);
                if (angle === 0) ctx10.moveTo(x, y);
                else ctx10.lineTo(x, y);
            }
            ctx10.closePath();
            ctx10.stroke();

            // Observation angle indicator
            const obsRad = toRad(observeAngle10);
            ctx10.strokeStyle = '#ff6644';
            ctx10.lineWidth = 2;
            ctx10.beginPath();
            ctx10.moveTo(diagramX, diagramY);
            ctx10.lineTo(diagramX + (diagramR + 20) * Math.cos(obsRad), diagramY - (diagramR + 20) * Math.sin(obsRad));
            ctx10.stroke();

            // Labels
            ctx10.fillStyle = '#fff';
            ctx10.font = '12px Arial';
            ctx10.textAlign = 'center';
            ctx10.fillText('æ•£å°„å¼ºåº¦åˆ†å¸ƒ', diagramX, diagramY + diagramR + 25);
            ctx10.fillText(`è§‚å¯Ÿè§’: ${observeAngle10}Â°`, diagramX, diagramY + diagramR + 40);

            // Legend
            ctx10.fillStyle = '#64c8ff';
            ctx10.font = '14px Arial';
            ctx10.textAlign = 'left';
            ctx10.fillText(`ç²’å¾„: ${particleSize10}nm`, 20, 30);
            ctx10.fillText(`Î»/d â‰ˆ ${(500 / particleSize10).toFixed(1)}`, 20, 50);

            time10++;
            requestAnimationFrame(drawDemo10);
        }

        document.getElementById('particleSize10').addEventListener('input', updateDemo10);
        document.getElementById('observeAngle10').addEventListener('input', updateDemo10);
        updateDemo10();
        drawDemo10();

        // ============ DEMO 11: Stokes & Mueller ============
        const canvas11 = document.getElementById('canvas11');
        const ctx11 = canvas11.getContext('2d');

        // Stokes vectors for different polarization states
        const stokesVectors = {
            'horizontal': [1, 1, 0, 0],
            'vertical': [1, -1, 0, 0],
            'diagonal': [1, 0, 1, 0],
            'antidiagonal': [1, 0, -1, 0],
            'circular_r': [1, 0, 0, 1],
            'circular_l': [1, 0, 0, -1],
            'unpolarized': [1, 0, 0, 0]
        };

        // Mueller matrices for optical elements
        const muellerMatrices = {
            'polarizer_h': [[0.5, 0.5, 0, 0], [0.5, 0.5, 0, 0], [0, 0, 0, 0], [0, 0, 0, 0]],
            'polarizer_v': [[0.5, -0.5, 0, 0], [-0.5, 0.5, 0, 0], [0, 0, 0, 0], [0, 0, 0, 0]],
            'polarizer_45': [[0.5, 0, 0.5, 0], [0, 0, 0, 0], [0.5, 0, 0.5, 0], [0, 0, 0, 0]],
            'qwp': [[1, 0, 0, 0], [0, 1, 0, 0], [0, 0, 0, -1], [0, 0, 1, 0]],
            'hwp': [[1, 0, 0, 0], [0, 1, 0, 0], [0, 0, -1, 0], [0, 0, 0, -1]],
            'depolarizer': [[1, 0, 0, 0], [0, 0, 0, 0], [0, 0, 0, 0], [0, 0, 0, 0]],
            'identity': [[1, 0, 0, 0], [0, 1, 0, 0], [0, 0, 1, 0], [0, 0, 0, 1]]
        };

        let currentStokes = 'horizontal';
        let currentMueller = 'polarizer_h';
        let time11 = 0;

        function setStokesInput(type) {
            currentStokes = type;
            updateDemo11();
        }

        function setMuellerElement(type) {
            currentMueller = type;
            updateDemo11();
        }

        function multiplyMuellerStokes(M, S) {
            const result = [0, 0, 0, 0];
            for (let i = 0; i < 4; i++) {
                for (let j = 0; j < 4; j++) {
                    result[i] += M[i][j] * S[j];
                }
            }
            return result;
        }

        function updateDemo11() {
            const Sin = stokesVectors[currentStokes];
            const M = muellerMatrices[currentMueller];
            const Sout = multiplyMuellerStokes(M, Sin);

            document.getElementById('stokesIn11').textContent = `[${Sin.map(v => v.toFixed(1)).join(', ')}]`;
            document.getElementById('stokesOut11').textContent = `[${Sout.map(v => v.toFixed(2)).join(', ')}]`;
        }

        function drawDemo11() {
            const w = canvas11.width;
            const h = canvas11.height;
            ctx11.clearRect(0, 0, w, h);

            const Sin = stokesVectors[currentStokes];
            const M = muellerMatrices[currentMueller];
            const Sout = multiplyMuellerStokes(M, Sin);

            // Draw input polarization (PoincarÃ© sphere projection)
            const sphereX1 = 150;
            const sphereY = h / 2;
            const sphereR = 80;

            // Draw PoincarÃ© sphere (simplified 2D projection)
            ctx11.strokeStyle = '#333';
            ctx11.lineWidth = 1;
            ctx11.beginPath();
            ctx11.arc(sphereX1, sphereY, sphereR, 0, Math.PI * 2);
            ctx11.stroke();

            // Axes
            ctx11.strokeStyle = '#444';
            ctx11.beginPath();
            ctx11.moveTo(sphereX1 - sphereR, sphereY);
            ctx11.lineTo(sphereX1 + sphereR, sphereY);
            ctx11.moveTo(sphereX1, sphereY - sphereR);
            ctx11.lineTo(sphereX1, sphereY + sphereR);
            ctx11.stroke();

            // Input state point
            const inX = sphereX1 + Sin[1] * sphereR * 0.9;
            const inY = sphereY - Sin[2] * sphereR * 0.9;
            ctx11.fillStyle = '#00ccff';
            ctx11.beginPath();
            ctx11.arc(inX, inY, 10, 0, Math.PI * 2);
            ctx11.fill();

            // Draw input wave animation
            ctx11.strokeStyle = '#00ccff';
            ctx11.lineWidth = 2;
            ctx11.beginPath();
            for (let i = 0; i < 60; i++) {
                const t = (i - time11 * 0.1) * 0.1;
                const ex = Sin[0] > 0 ? (Sin[1] >= 0 ? 1 : -1) * Math.sqrt((1 + Sin[1]) / 2) : 0;
                const ey = Sin[0] > 0 ? Math.sqrt((1 - Sin[1]) / 2) : 0;
                const phase = Sin[3] > 0 ? Math.PI / 2 : (Sin[3] < 0 ? -Math.PI / 2 : 0);

                const px = 50 + i * 2;
                const py = sphereY - 120 + Math.sin(t) * 20 * ex;
                if (i === 0) ctx11.moveTo(px, py);
                else ctx11.lineTo(px, py);
            }
            ctx11.stroke();

            // Labels for input
            ctx11.fillStyle = '#00ccff';
            ctx11.font = '16px Arial';
            ctx11.textAlign = 'center';
            ctx11.fillText('å…¥å°„åæŒ¯æ€', sphereX1, sphereY + sphereR + 30);
            ctx11.font = '12px Arial';
            ctx11.fillText(`S = [${Sin.join(', ')}]`, sphereX1, sphereY + sphereR + 50);

            // Draw Mueller matrix (center)
            const matrixX = w / 2;
            const matrixY = sphereY;
            const cellSize = 35;

            ctx11.fillStyle = 'rgba(100, 200, 255, 0.1)';
            ctx11.fillRect(matrixX - cellSize * 2, matrixY - cellSize * 2, cellSize * 4, cellSize * 4);

            ctx11.strokeStyle = '#64c8ff';
            ctx11.lineWidth = 2;
            ctx11.strokeRect(matrixX - cellSize * 2, matrixY - cellSize * 2, cellSize * 4, cellSize * 4);

            ctx11.fillStyle = '#fff';
            ctx11.font = '12px monospace';
            ctx11.textAlign = 'center';
            for (let i = 0; i < 4; i++) {
                for (let j = 0; j < 4; j++) {
                    const val = M[i][j];
                    const x = matrixX - cellSize * 1.5 + j * cellSize;
                    const y = matrixY - cellSize * 1.5 + i * cellSize + 5;
                    ctx11.fillText(val.toFixed(1), x, y);
                }
            }

            ctx11.fillStyle = '#ffcc00';
            ctx11.font = '14px Arial';
            ctx11.fillText('MuellerçŸ©é˜µ', matrixX, matrixY - cellSize * 2 - 10);

            // Draw output polarization
            const sphereX2 = w - 150;

            ctx11.strokeStyle = '#333';
            ctx11.lineWidth = 1;
            ctx11.beginPath();
            ctx11.arc(sphereX2, sphereY, sphereR, 0, Math.PI * 2);
            ctx11.stroke();

            ctx11.strokeStyle = '#444';
            ctx11.beginPath();
            ctx11.moveTo(sphereX2 - sphereR, sphereY);
            ctx11.lineTo(sphereX2 + sphereR, sphereY);
            ctx11.moveTo(sphereX2, sphereY - sphereR);
            ctx11.lineTo(sphereX2, sphereY + sphereR);
            ctx11.stroke();

            // Output state point
            if (Sout[0] > 0.01) {
                const outX = sphereX2 + (Sout[1] / Sout[0]) * sphereR * 0.9;
                const outY = sphereY - (Sout[2] / Sout[0]) * sphereR * 0.9;
                ctx11.fillStyle = '#ffcc00';
                ctx11.beginPath();
                ctx11.arc(outX, outY, 10, 0, Math.PI * 2);
                ctx11.fill();
            }

            // Draw output wave
            ctx11.strokeStyle = `rgba(255, 204, 0, ${Sout[0]})`;
            ctx11.lineWidth = 2;
            ctx11.beginPath();
            for (let i = 0; i < 60; i++) {
                const t = (i - time11 * 0.1) * 0.1;
                const amp = Math.sqrt(Sout[0]) * 20;
                const px = sphereX2 - 60 + i * 2;
                const py = sphereY - 120 + Math.sin(t) * amp * (Sout[0] > 0 ? (Sout[1] >= 0 ? 1 : -1) : 0);
                if (i === 0) ctx11.moveTo(px, py);
                else ctx11.lineTo(px, py);
            }
            ctx11.stroke();

            // Labels for output
            ctx11.fillStyle = '#ffcc00';
            ctx11.font = '16px Arial';
            ctx11.textAlign = 'center';
            ctx11.fillText('å‡ºå°„åæŒ¯æ€', sphereX2, sphereY + sphereR + 30);
            ctx11.font = '12px Arial';
            ctx11.fillText(`S' = [${Sout.map(v => v.toFixed(2)).join(', ')}]`, sphereX2, sphereY + sphereR + 50);

            // Intensity bar
            ctx11.fillStyle = '#333';
            ctx11.fillRect(sphereX2 - 50, sphereY + sphereR + 70, 100, 15);
            ctx11.fillStyle = '#ffcc00';
            ctx11.fillRect(sphereX2 - 50, sphereY + sphereR + 70, 100 * Sout[0], 15);
            ctx11.fillStyle = '#fff';
            ctx11.font = '10px Arial';
            ctx11.fillText(`é€å°„ç‡: ${(Sout[0] * 100).toFixed(0)}%`, sphereX2, sphereY + sphereR + 100);

            // Arrows
            ctx11.strokeStyle = '#666';
            ctx11.lineWidth = 2;
            ctx11.beginPath();
            ctx11.moveTo(sphereX1 + sphereR + 20, sphereY);
            ctx11.lineTo(matrixX - cellSize * 2 - 20, sphereY);
            ctx11.moveTo(matrixX + cellSize * 2 + 20, sphereY);
            ctx11.lineTo(sphereX2 - sphereR - 20, sphereY);
            ctx11.stroke();

            // Arrow heads
            ctx11.fillStyle = '#666';
            ctx11.beginPath();
            ctx11.moveTo(matrixX - cellSize * 2 - 20, sphereY);
            ctx11.lineTo(matrixX - cellSize * 2 - 30, sphereY - 5);
            ctx11.lineTo(matrixX - cellSize * 2 - 30, sphereY + 5);
            ctx11.fill();
            ctx11.beginPath();
            ctx11.moveTo(sphereX2 - sphereR - 20, sphereY);
            ctx11.lineTo(sphereX2 - sphereR - 30, sphereY - 5);
            ctx11.lineTo(sphereX2 - sphereR - 30, sphereY + 5);
            ctx11.fill();

            time11++;
            requestAnimationFrame(drawDemo11);
        }

        updateDemo11();
        drawDemo11();

    </script>
</body>
</html>
